<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎸 The Ultimate Guitar Chord Library</title>
    <style>
        /* --- Basic Setup & Typography --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-color: #f0f2ff;
            --text-color: #2d3748;
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #5D5CDE;
            --secondary-color: #718096;
            --card-gradient: linear-gradient(145deg, #ffffff 0%, #f7fafc 100%);
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --shadow-color: rgba(102, 126, 234, 0.2);
            --fret-color: #cbd5e0;
            --string-color: #4a5568;
            --dot-gradient: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            --dot-color: #ff6b6b;
            --dot-text-color: #fff;
            --success-gradient: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
            --success-color: #28a745;
            --checkbox-bg: #ffffff;
            --checkbox-border: #cbd5e0;
            --accent-gradient: linear-gradient(135deg, #ffd93d 0%, #ff9f43 100%);
            --accent-color: #ffd93d;
            --purple-gradient: linear-gradient(135deg, #a855f7 0%, #8b5cf6 100%);
            --blue-gradient: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            --green-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .dark {
            --bg-color: #1a1a2e;
            --text-color: #e0e0e0;
            --secondary-color: #a0a0a0;
            --card-bg: #16213e;
            --border-color: #404040;
            --shadow-color: rgba(0, 0, 0, 0.4);
            --fret-color: #666;
            --string-color: #888;
            --dot-color: #e0e0e0;
            --dot-text-color: #333;
            --checkbox-bg: #2a2a2a;
            --checkbox-border: #555;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            position: relative;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(168, 85, 247, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        /* --- Header & Navigation --- */
        .header {
            background: var(--card-gradient);
            padding: 1.5rem 2rem;
            border-bottom: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        .header h1 {
            margin: 0 0 0.5rem 0;
            font-size: 2.2rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 8px var(--shadow-color);
            position: relative;
        }
        .navigation {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        .nav-link {
            text-decoration: none;
            color: var(--secondary-color);
            font-size: 1rem;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            background: var(--card-bg);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .nav-link:hover {
            background: var(--primary-gradient);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }
        .nav-link.active {
            background: var(--primary-gradient);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-color);
        }
        /* --- Dark Mode Toggle --- */
        .header-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .dark-mode-toggle {
            background: var(--accent-gradient);
            border: none;
            border-radius: 25px;
            padding: 0.75rem 1.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(255, 217, 61, 0.3);
        }
        .dark-mode-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 217, 61, 0.4);
        }
        .toggle-icon {
            font-size: 1.2rem;
        }
        /* --- Main Content & Page Switching --- */
        .main-content {
            flex: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            position: relative;
        }
        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        .page.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* --- Library Page Controls --- */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--card-gradient);
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px var(--shadow-color);
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }
        .control-group:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }
        .control-group label {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: var(--text-color);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .selector {
            padding: 1rem 1.5rem;
            font-size: 1.1rem;
            border: 2px solid var(--border-color);
            border-radius: 15px;
            background: var(--card-bg);
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23667eea' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 3rem;
            min-width: 150px;
            font-weight: 600;
        }
        .selector:hover {
            border-color: var(--primary-color);
            transform: scale(1.05);
            box-shadow: 0 4px 20px var(--shadow-color);
        }
        .selector:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.25);
        }
        /* --- Shared Chord Diagram Styles --- */
        #chord-display, .chord-guide-display {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin-bottom: 4rem;
            position: relative;
        }
        
        .chord-diagram-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
            background: var(--card-gradient);
            padding: 3rem;
            border-radius: 25px;
            box-shadow: 0 12px 40px var(--shadow-color);
            border: 3px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 480px;
            width: 500px;
        }
        .chord-diagram-wrapper::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, rgba(102, 126, 234, 0.1), rgba(255, 107, 107, 0.1), rgba(168, 85, 247, 0.1), rgba(102, 126, 234, 0.1));
            animation: rotate 10s linear infinite;
            z-index: -1;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .chord-diagram-wrapper:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 60px var(--shadow-color);
        }
        .chord-diagram {
            width: 300px;
            position: relative;
            margin-top: 1.5rem;
        }
        .fretboard {
            position: relative;
            width: 100%;
        }
        .string {
            height: 360px;
            width: 3px;
            background: linear-gradient(180deg, var(--string-color) 0%, #8a8a8a 100%);
            position: absolute;
            border-radius: 2px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .fret {
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--fret-color) 0%, #999 100%);
            position: absolute;
            border-radius: 2px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .nut {
            height: 12px;
            background: linear-gradient(180deg, #333 0%, #666 100%);
            border-radius: 4px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }
        .dot {
            width: 32px;
            height: 32px;
            background: var(--dot-gradient);
            border-radius: 50%;
            position: absolute;
            transform: translate(-50%, -50%);
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--dot-text-color);
            font-size: 1.1rem;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
            z-index: 2;
            border: 3px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        .dot:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }
        .bar {
            position: absolute;
            background: var(--dot-gradient);
            border-radius: 15px;
            z-index: 1;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .open-string, .muted-string {
            position: absolute;
            transform: translateX(-50%);
            font-size: 1.6rem;
            font-weight: bold;
            top: -50px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        .open-string { 
            color: var(--green-gradient);
            filter: drop-shadow(0 0 8px rgba(16, 185, 129, 0.5));
        }
        .muted-string { 
            color: #ff4757;
            filter: drop-shadow(0 0 8px rgba(255, 71, 87, 0.5));
        }
        #chord-name, .chord-guide-name {
            font-size: 2.8rem;
            font-weight: 800;
            margin: 0;
            color: var(--primary-color);
            text-shadow: 0 4px 8px var(--shadow-color);
            text-align: center;
        }
        
        .chord-guide-name {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            margin-top: 0;
        }
        #no-chord-message {
            font-size: 1.4rem;
            color: var(--secondary-color);
            padding: 3rem;
            border: 3px dashed var(--border-color);
            border-radius: 20px;
            text-align: center;
            background: var(--card-gradient);
            box-shadow: 0 8px 32px var(--shadow-color);
        }
        /* --- Songs Page Specific Styles --- */
        .page-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-color);
            text-shadow: 0 2px 4px var(--shadow-color);
        }
        
        .page-subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: #4a5568;
            margin-bottom: 3rem;
            font-weight: 500;
        }
        .dark .page-subtitle {
            color: var(--secondary-color);
        }
        .song-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }
        .song-card {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .song-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-gradient);
        }
        .song-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 16px 48px var(--shadow-color);
        }
        .song-card h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.6rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        .song-card .artist {
            margin: 0 0 1.5rem 0;
            font-size: 1.1rem;
            color: var(--secondary-color);
            font-style: italic;
            font-weight: 500;
        }
        .song-card .chords {
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.2rem;
            font-weight: bold;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            word-spacing: 0.5em;
            letter-spacing: 1px;
        }
        
        .chord-guide-display {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 3rem;
            flex-direction: row;
        }
        /* --- Collapsible Chord Section --- */
        .chord-toggle-section {
            margin-top: 2rem;
            border-top: 2px solid var(--border-color);
            padding-top: 1.5rem;
        }
        .chord-toggle-btn {
            width: 100%;
            padding: 1rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }
        .chord-toggle-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
        }
        .chord-toggle-btn:active {
            transform: translateY(-1px);
        }
        .chord-toggle-btn .arrow {
            transition: transform 0.3s ease;
            font-size: 1rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }
        .chord-toggle-btn.expanded .arrow {
            transform: rotate(180deg);
        }
        .song-chord-display {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 3rem;
            margin-top: 1.5rem;
            padding: 3rem;
            background: var(--bg-color);
            border-radius: 15px;
            border: 2px solid var(--border-color);
            box-shadow: inset 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .song-chord-display.expanded {
            display: flex;
        }
        .chord-row {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            margin-bottom: 0;
        }
        .song-chord-display .chord-diagram {
            width: 200px;
        }
        .song-chord-display .string {
            height: 240px;
        }
        .song-chord-display .dot {
            width: 26px;
            height: 26px;
            font-size: 0.9rem;
        }
        .song-chord-display .chord-guide-name {
            font-size: 1.6rem;
            margin-bottom: 0.5rem;
            margin-top: 0;
        }
        .song-chord-display .chord-diagram-wrapper {
            padding: 2rem;
            min-height: 384px;
        }
        /* --- Progress Page Styles --- */
        .progress-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }
        .stat-card {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            min-width: 180px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--success-gradient);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        .stat-label {
            color: var(--secondary-color);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        .progress-bar-container {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2.5rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            overflow: hidden;
        }
        .progress-bar-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-gradient);
        }
        .progress-bar-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .progress-bar-title {
            font-size: 1.6rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        .progress-bar-subtitle {
            color: var(--secondary-color);
            font-size: 1rem;
            font-weight: 500;
        }
        .progress-bar-wrapper {
            position: relative;
            width: 100%;
            height: 25px;
            background: var(--border-color);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 1.5rem;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .progress-bar-fill {
            height: 100%;
            background: var(--success-gradient);
            border-radius: 15px;
            transition: width 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(81, 207, 102, 0.5);
        }
        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }
        .progress-bar-text {
            text-align: center;
            font-size: 1rem;
            color: var(--text-color);
            margin-top: 0.75rem;
            font-weight: 600;
        }
        .progress-milestones {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
            font-size: 0.9rem;
            color: var(--secondary-color);
        }
        .milestone {
            text-align: center;
            flex: 1;
            padding: 0.75rem;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .milestone.achieved {
            background: var(--success-gradient);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(81, 207, 102, 0.3);
        }
        .chord-progress-grid {
            display: flex;
            flex-direction: column;
            gap: 3rem;
            margin-bottom: 4rem;
        }
        .difficulty-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: var(--card-gradient);
            border-radius: 15px;
            box-shadow: 0 6px 24px var(--shadow-color);
        }
        .difficulty-header h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .difficulty-header p {
            margin: 0;
            color: var(--secondary-color);
            font-size: 1rem;
            font-weight: 500;
        }
        .difficulty-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1rem;
        }
        .chord-indicator {
            width: 24px;
            height: 24px;
            border: 3px solid var(--primary-color);
            border-radius: 50%;
            background: var(--card-bg);
            cursor: default;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
            color: var(--primary-color);
            font-size: 1rem;
            font-weight: 600;
        }
        .chord-progress-item {
            background: var(--card-gradient);
            border-radius: 15px;
            padding: 1.5rem;
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 6px 24px var(--shadow-color);
        }
        .chord-progress-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 32px var(--shadow-color);
            border-color: var(--primary-color);
        }
        .chord-progress-item.learned {
            border-color: var(--success-color);
            background: linear-gradient(145deg, #f0fff4 0%, #ffffff 100%);
            box-shadow: 0 6px 24px rgba(81, 207, 102, 0.2);
        }
        .chord-checkbox {
            width: 24px;
            height: 24px;
            border: 3px solid var(--checkbox-border);
            border-radius: 6px;
            background: var(--checkbox-bg);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
            font-weight: bold;
        }
        .chord-checkbox.checked {
            background: var(--success-gradient);
            border-color: var(--success-color);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(81, 207, 102, 0.4);
        }
        .chord-checkbox:hover {
            border-color: var(--primary-color);
            transform: scale(1.05);
        }
        .chord-info {
            flex: 1;
        }
        .chord-info h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1.3rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .chord-info p {
            margin: 0;
            font-size: 1rem;
            color: var(--secondary-color);
            font-weight: 500;
        }
        .mini-chord-diagram {
            width: 120px;
            flex-shrink: 0;
            margin-right: 12px;
            margin-top: -15px;
        }
        .mini-chord-diagram .string {
            height: 90px;
        }
        .mini-chord-diagram .dot {
            width: 14px;
            height: 14px;
            font-size: 0.7rem;
        }
        .mini-chord-diagram .chord-guide-name {
            display: block;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
            margin-top: 0;
            text-align: center;
            font-weight: 600;
        }
        .mini-chord-diagram .open-string, 
        .mini-chord-diagram .muted-string {
            font-size: 1rem;
            top: -28px;
        }
        .mini-chord-diagram .chord-diagram-wrapper {
            padding: 1rem;
            min-height: 168px;
        }
        
        /* --- Practice Timer Page Styles --- */
        .timer-container {
            background: var(--card-gradient);
            border-radius: 25px;
            padding: 3.5rem;
            border: 3px solid var(--border-color);
            box-shadow: 0 12px 48px var(--shadow-color);
            margin-bottom: 3rem;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .timer-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--blue-gradient);
        }
        
        .timer-display {
            font-size: 4.5rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 2.5rem 0;
            font-family: 'Courier New', monospace;
            letter-spacing: 0.1em;
            text-shadow: 0 4px 8px var(--shadow-color);
        }
        
        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .timer-input-group {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .timer-input {
            padding: 1rem;
            font-size: 1.2rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--card-bg);
            color: var(--text-color);
            width: 90px;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .timer-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.25);
            transform: scale(1.05);
        }
        
        .timer-btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }
        
        .timer-btn.primary {
            background: var(--primary-gradient);
            color: white;
        }
        
        .timer-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
        }
        
        .timer-btn.secondary {
            background: var(--secondary-color);
            color: white;
        }
        
        .timer-btn.secondary:hover {
            transform: translateY(-3px);
            opacity: 0.9;
        }
        
        .timer-btn.success {
            background: var(--success-gradient);
            color: white;
        }
        
        .timer-btn.success:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(81, 207, 102, 0.4);
        }
        
        .timer-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .timer-status {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .timer-status.idle {
            color: var(--secondary-color);
        }
        
        .timer-status.running {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .timer-status.paused {
            color: #ffc107;
        }
        
        .timer-status.finished {
            background: var(--success-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .practice-tips {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .tip-card {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .tip-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--purple-gradient);
        }
        .tip-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }
        
        .tip-card h3 {
            margin: 0 0 1rem 0;
            font-size: 1.4rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        
        .tip-card p {
            margin: 0;
            color: var(--text-color);
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .preset-times {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .preset-btn {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .preset-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--shadow-color);
        }
        
        .preset-btn.active {
            background: var(--primary-gradient);
            border-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        /* --- Metronome Page Styles --- */
        .metronome-container {
            background: var(--card-gradient);
            border-radius: 25px;
            padding: 3.5rem;
            border: 3px solid var(--border-color);
            box-shadow: 0 12px 48px var(--shadow-color);
            margin-bottom: 3rem;
            text-align: center;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .metronome-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--green-gradient);
        }
        
        .metronome-display {
            font-size: 4.5rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 2.5rem 0;
            font-family: 'Courier New', monospace;
            letter-spacing: 0.1em;
            text-shadow: 0 4px 8px var(--shadow-color);
        }
        
        .bpm-container {
            margin: 2.5rem 0;
        }
        
        .bpm-label {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .bpm-slider-container {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin: 2rem 0;
            justify-content: center;
        }
        
        .bpm-input {
            width: 100px;
            padding: 0.75rem;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--card-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        
        .bpm-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.25);
        }
        
        .bpm-slider {
            flex: 1;
            max-width: 500px;
            height: 10px;
            border-radius: 6px;
            background: var(--border-color);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }
        
        .bpm-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--primary-gradient);
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            border: 3px solid white;
        }
        
        .bpm-slider::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--primary-gradient);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .time-signature-container {
            margin: 2.5rem 0;
        }
        
        .time-signature-label {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .time-signature-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .time-sig-btn {
            padding: 0.75rem 1.5rem;
            font-size: 1.1rem;
            font-weight: 700;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
        }
        
        .time-sig-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--shadow-color);
        }
        
        .time-sig-btn.active {
            background: var(--primary-gradient);
            border-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }
        
        .beat-indicators {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 2.5rem 0;
        }
        
        .beat-indicator {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid var(--border-color);
            background: var(--card-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--secondary-color);
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px var(--shadow-color);
        }
        
        .beat-indicator.active {
            border-color: var(--primary-color);
            background: var(--primary-gradient);
            color: white;
            transform: scale(1.15);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.4);
        }
        
        .beat-indicator.accent {
            border-color: #ff6b6b;
            background: var(--dot-gradient);
            color: white;
            transform: scale(1.25);
            box-shadow: 0 8px 30px rgba(255, 107, 107, 0.5);
        }
        
        .metronome-controls {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 2.5rem 0;
            flex-wrap: wrap;
        }
        
        .metronome-btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metronome-btn.start {
            background: var(--success-gradient);
            color: white;
            box-shadow: 0 6px 20px rgba(81, 207, 102, 0.3);
        }
        
        .metronome-btn.start:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(81, 207, 102, 0.4);
        }
        
        .metronome-btn.stop {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.3);
        }
        
        .metronome-btn.stop:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(255, 107, 107, 0.4);
        }
        
        .metronome-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .metronome-status {
            font-size: 1.3rem;
            margin: 1.5rem 0;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metronome-status.stopped {
            color: var(--secondary-color);
        }
        
        .metronome-status.running {
            background: var(--success-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* --- Strumming Patterns Page Styles --- */
        .strumming-patterns-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .pattern-card {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .pattern-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-gradient);
        }

        .pattern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }

        .pattern-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .pattern-name {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .pattern-difficulty {
            padding: 0.5rem 1rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .pattern-difficulty.beginner {
            background: var(--success-gradient);
            color: white;
        }

        .pattern-difficulty.intermediate {
            background: var(--accent-gradient);
            color: white;
        }

        .pattern-difficulty.advanced {
            background: var(--dot-gradient);
            color: white;
        }

        .pattern-notation {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem 0;
            font-family: 'Courier New', monospace;
            font-size: 1.8rem;
            font-weight: bold;
            letter-spacing: 0.4rem;
            background: var(--bg-color);
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid var(--border-color);
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .strum-down {
            color: #2d5aa0;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(45, 90, 160, 0.3);
        }

        .strum-up {
            color: #e74c3c;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(231, 76, 60, 0.3);
        }

        .strum-mute {
            color: #f39c12;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(243, 156, 18, 0.3);
        }

        .strum-rest {
            color: var(--secondary-color);
        }

        .pattern-info {
            margin-bottom: 1.5rem;
        }

        .pattern-description {
            color: var(--text-color);
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 0.75rem;
            font-weight: 500;
        }

        .pattern-time-signature {
            color: var(--secondary-color);
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .pattern-genre {
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-style: italic;
            font-weight: 500;
        }

        .pattern-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .pattern-play-btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .pattern-play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .pattern-play-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .beat-numbers {
            display: flex;
            justify-content: center;
            gap: 1.8rem;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            color: var(--secondary-color);
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .legend {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            margin-bottom: 2.5rem;
            text-align: center;
            box-shadow: 0 8px 32px var(--shadow-color);
            position: relative;
            overflow: hidden;
        }
        .legend::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--blue-gradient);
        }

        .legend h3 {
            margin: 0 0 1.5rem 0;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.4rem;
            font-weight: 700;
        }

        .legend-items {
            display: flex;
            justify-content: center;
            gap: 2.5rem;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            background: var(--bg-color);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        .legend-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .legend-symbol {
            font-weight: bold;
            font-size: 1.4rem;
        }

        .filter-controls {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-color);
        }

        .filter-btn.active {
            background: var(--primary-gradient);
            border-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        /* --- Tab Tutorial Page Styles --- */
        .tab-tutorial-nav {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .tab-nav-btn {
            padding: 0.75rem 1.5rem;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .tab-nav-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-color);
        }

        .tab-nav-btn.active {
            background: var(--primary-gradient);
            border-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .tab-section {
            display: none;
        }

        .tab-section.active {
            display: block;
        }

        .lesson-container {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2.5rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .lesson-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }

        .lesson-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .lesson-title {
            font-size: 2rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .lesson-subtitle {
            color: var(--secondary-color);
            font-size: 1.1rem;
            font-weight: 500;
        }

        .lesson-content {
            display: none;
        }

        .lesson-content.active {
            display: block;
            animation: slideIn 0.3s ease-in-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .lesson-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--border-color);
        }

        .lesson-nav-btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .lesson-nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .lesson-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .lesson-progress {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .progress-text {
            font-size: 0.9rem;
            color: var(--secondary-color);
            font-weight: 600;
        }

        .progress-dots {
            display: flex;
            gap: 0.5rem;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border-color);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--primary-gradient);
            transform: scale(1.2);
        }

        .progress-dot.completed {
            background: var(--success-gradient);
        }

        .tab-staff {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            font-family: 'Courier New', monospace;
            position: relative;
            overflow-x: auto;
        }

        .tab-lines {
            position: relative;
            height: 200px;
            margin: 1rem 0;
        }

        .tab-line {
            position: absolute;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border-color);
            border-radius: 1px;
        }

        .tab-line:nth-child(1) { top: 0; }
        .tab-line:nth-child(2) { top: 33px; }
        .tab-line:nth-child(3) { top: 66px; }
        .tab-line:nth-child(4) { top: 99px; }
        .tab-line:nth-child(5) { top: 132px; }
        .tab-line:nth-child(6) { top: 165px; }

        .tab-labels {
            position: absolute;
            left: -30px;
            top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-weight: bold;
            color: var(--text-color);
        }

        .tab-note {
            position: absolute;
            background: var(--primary-gradient);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            animation: pulse 2s infinite;
        }

        .tab-note:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .tab-note.highlighted {
            background: var(--accent-gradient);
            animation: bounce 0.6s ease-in-out;
            box-shadow: 0 6px 20px rgba(255, 217, 61, 0.6);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes bounce {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
        }

        .tab-explanation {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .tab-explanation h4 {
            margin: 0 0 1rem 0;
            color: var(--primary-color);
            font-size: 1.2rem;
            font-weight: 700;
        }

        .tab-explanation p {
            margin: 0;
            color: var(--text-color);
            line-height: 1.6;
        }

        .exercise-container {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            margin-bottom: 2rem;
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .exercise-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .exercise-difficulty {
            padding: 0.5rem 1rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .exercise-difficulty.beginner {
            background: var(--success-gradient);
            color: white;
        }

        .exercise-difficulty.intermediate {
            background: var(--accent-gradient);
            color: white;
        }

        .exercise-difficulty.advanced {
            background: var(--dot-gradient);
            color: white;
        }

        .exercise-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .exercise-btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .exercise-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .exercise-btn.secondary {
            background: var(--secondary-color);
        }

        .exercise-btn.success {
            background: var(--success-gradient);
        }

        .feedback-display {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            margin-top: 1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback-display.success {
            border-color: var(--success-color);
            background: linear-gradient(145deg, #f0fff4 0%, #ffffff 100%);
            color: var(--success-color);
        }

        .feedback-display.error {
            border-color: #ff4757;
            background: linear-gradient(145deg, #fff5f5 0%, #ffffff 100%);
            color: #ff4757;
        }

        .reference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .reference-card {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
            transition: all 0.3s ease;
        }

        .reference-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }

        .reference-card h3 {
            margin: 0 0 1.5rem 0;
            font-size: 1.4rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }

        .symbol-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .symbol-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .symbol-item:last-child {
            border-bottom: none;
        }

        .symbol-notation {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary-color);
            background: var(--bg-color);
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
        }

        .symbol-description {
            flex: 1;
            margin-left: 1rem;
            color: var(--text-color);
            font-weight: 500;
        }

        .chord-tab-link {
            background: var(--accent-gradient);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin-top: 2rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-color);
        }

        .chord-tab-link h3 {
            margin: 0 0 1rem 0;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .chord-tab-link p {
            margin: 0 0 1.5rem 0;
            opacity: 0.9;
        }

        .chord-tab-link button {
            background: white;
            color: var(--primary-color);
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chord-tab-link button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        /* --- Footer --- */
        .footer {
            text-align: center;
            padding: 2rem;
            font-size: 1rem;
            color: var(--secondary-color);
            margin-top: 3rem;
            background: var(--card-gradient);
            border-top: 2px solid var(--border-color);
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        /* --- Responsive Design --- */
        @media (max-width: 600px) {
            .header h1 { font-size: 1.8rem; }
            .main-content { padding: 1rem; }
            .controls { flex-direction: column; gap: 1.5rem; }
            #chord-name { font-size: 2.2rem; }
            .page-title { font-size: 2rem; }
            .chord-row { gap: 1rem; }
            #chord-display, .chord-guide-display { margin-bottom: 2rem; }
            .navigation { gap: 1rem; }
            .progress-stats { gap: 1rem; }
            .stat-card { min-width: 140px; padding: 1.5rem; }
            .progress-bar-container { padding: 2rem; margin-bottom: 1.5rem; }
            .timer-container { padding: 2.5rem; }
            .timer-display { font-size: 3.5rem; }
            .timer-input-group { gap: 1rem; }
            .timer-input { width: 70px; }
            .metronome-container { padding: 2.5rem; }
            .metronome-display { font-size: 3.5rem; }
            .bpm-slider-container { flex-direction: column; gap: 1rem; }
            .beat-indicator { width: 60px; height: 60px; }
            .strumming-patterns-grid { grid-template-columns: 1fr; }
            .pattern-notation { font-size: 1.4rem; letter-spacing: 0.3rem; }
            .legend-items { gap: 1.5rem; }
            .filter-controls { gap: 1rem; }
            .chord-diagram { width: 250px; }
            .song-chord-display .chord-diagram { width: 180px; }
            .chord-diagram-wrapper { padding: 2rem; min-height: 360px; }
            .song-chord-display .chord-diagram-wrapper { padding: 1.5rem; min-height: 300px; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-controls">
            <div></div> <!-- Empty div for spacing -->
            <h1>🎸 The Ultimate Guitar Tools ✨</h1>
            <button class="dark-mode-toggle" id="darkModeToggle">
                <span class="toggle-icon">🌙</span>
                <span>Dark</span>
            </button>
        </div>
        <nav class="navigation">
            <a href="#" class="nav-link active" data-page="library-page">🎵 Chord Library</a>
            <a href="#" class="nav-link" data-page="songs-page">🎤 Song Chords</a>
            <a href="#" class="nav-link" data-page="progress-page">📈 My Progress</a>
            <a href="#" class="nav-link" data-page="practice-page">⏰ Practice Timer</a>
            <a href="#" class="nav-link" data-page="tips-page">💡 Guitar Tips</a>
            <a href="#" class="nav-link" data-page="metronome-page">🎼 Metronome</a>
            <a href="#" class="nav-link" data-page="strumming-page">🎸 Strumming Patterns</a>
            <a href="#" class="nav-link" data-page="tab-tutorial-page">📝 Tab Tutorial</a>
        </nav>
    </header>
    <main class="main-content">
        <!-- Page 1: Chord Library -->
        <div id="library-page" class="page active">
            <p class="page-subtitle" style="text-align:center;">🌟 Your beautiful and elegant guide to guitar chords 🌟</p>
            <div class="controls">
                <div class="control-group">
                    <label for="root-note-selector">🎵 Root Note</label>
                    <select id="root-note-selector" class="selector"></select>
                </div>
                <div class="control-group">
                    <label for="chord-type-selector">🎸 Chord Type</label>
                    <select id="chord-type-selector" class="selector"></select>
                </div>
            </div>
            <div id="chord-display">
                <!-- Chord diagram will be generated here -->
            </div>
        </div>
        <!-- Page 2: Popular Songs -->
        <div id="songs-page" class="page">
            <h2 class="page-title">🎤 Popular Song Chords</h2>
            <p class="page-subtitle">🎶 Learn to play famous songs with these simple chord progressions 🎶</p>
            
            <div class="song-list" id="song-list">
                <!-- Song cards will be generated here -->
            </div>
        </div>
        <!-- Page 3: My Progress -->
        <div id="progress-page" class="page">
            <h2 class="page-title">📈 My Chord Progress</h2>
            <p class="page-subtitle">🏆 Track which chords you've mastered on your guitar journey 🏆</p>
            
            <div class="progress-stats" id="progress-stats">
                <!-- Progress statistics will be generated here -->
            </div>
            <div class="progress-bar-container" id="progress-bar-container">
                <div class="progress-bar-header">
                    <h3 class="progress-bar-title">🎯 Overall Progress</h3>
                    <p class="progress-bar-subtitle">✨ Your journey to guitar mastery ✨</p>
                </div>
                <div class="progress-bar-wrapper">
                    <div class="progress-bar-fill" id="progress-bar-fill" style="width: 0%"></div>
                </div>
                <div class="progress-bar-text" id="progress-bar-text">0 of 0 chords learned</div>
                <div class="progress-milestones">
                    <div class="milestone" id="milestone-25">25%<br>🌱 Beginner</div>
                    <div class="milestone" id="milestone-50">50%<br>🎸 Intermediate</div>
                    <div class="milestone" id="milestone-75">75%<br>⭐ Advanced</div>
                    <div class="milestone" id="milestone-100">100%<br>🏆 Master</div>
                </div>
            </div>
            <div style="text-align: center; margin-bottom: 2rem;">
                <button id="reset-progress-btn" class="chord-toggle-btn" style="width: auto; padding: 0.5rem 1.5rem; background-color: #dc3545; font-size: 0.9rem;">
                    🔄 Reset All Progress
                </button>
            </div>
            <div class="chord-progress-grid" id="chord-progress-grid">
                <!-- Chord progress items will be generated here -->
            </div>
        </div>
        
        <!-- Page 4: Practice Timer -->
        <div id="practice-page" class="page">
            <h2 class="page-title">⏰ Practice Timer</h2>
            <p class="page-subtitle">🎯 Set focused practice sessions to improve your guitar skills 🎯</p>
            
            <div class="timer-container">
                <div class="timer-status idle" id="timer-status">🎸 Ready to practice</div>
                <div class="timer-display" id="timer-display">05:00</div>
                
                <div class="preset-times">
                    <button class="preset-btn" data-minutes="5" data-seconds="0">⚡ 5 min</button>
                    <button class="preset-btn" data-minutes="10" data-seconds="0">🎵 10 min</button>
                    <button class="preset-btn active" data-minutes="15" data-seconds="0">🎸 15 min</button>
                    <button class="preset-btn" data-minutes="30" data-seconds="0">🔥 30 min</button>
                    <button class="preset-btn" data-minutes="45" data-seconds="0">💪 45 min</button>
                </div>
                
                <div class="timer-input-group">
                    <div>
                        <label for="minutes-input">⏰ Minutes</label>
                        <input type="number" id="minutes-input" class="timer-input" min="0" max="99" value="5">
                    </div>
                    <div>
                        <label for="seconds-input">⏱️ Seconds</label>
                        <input type="number" id="seconds-input" class="timer-input" min="0" max="59" value="0">
                    </div>
                </div>
                
                <div class="timer-controls">
                    <button class="timer-btn primary" id="start-pause-btn">▶️ Start</button>
                    <button class="timer-btn secondary" id="reset-btn">🔄 Reset</button>
                </div>
            </div>
        </div>
        
        <!-- Page 5: Guitar Tips -->
        <div id="tips-page" class="page">
            <h2 class="page-title">💡 Guitar Tips & Techniques</h2>
            <p class="page-subtitle">🚀 Essential tips to accelerate your guitar learning journey and improve your playing 🚀</p>
            
            <div class="practice-tips" id="all-guitar-tips">
                <!-- Tips will be generated here -->
            </div>
        </div>

        <!-- Page 6: Metronome -->
        <div id="metronome-page" class="page">
            <h2 class="page-title">🎼 Metronome</h2>
            <p class="page-subtitle">🎵 Keep perfect time while practicing with adjustable tempo and time signatures 🎵</p>
            
            <div class="metronome-container">
                <div class="metronome-status stopped" id="metronome-status">🎯 Ready to start</div>
                <div class="metronome-display" id="metronome-bpm-display">120</div>
                
                <div class="bpm-container">
                    <div class="bpm-label">🎵 Tempo (BPM)</div>
                    <div class="bpm-slider-container">
                        <span>30</span>
                        <input type="range" id="bpm-slider" class="bpm-slider" min="30" max="200" value="120">
                        <span>200</span>
                    </div>
                    <input type="number" id="bpm-input" class="bpm-input" min="30" max="200" value="120">
                </div>
                
                <div class="time-signature-container">
                    <div class="time-signature-label">🎼 Time Signature</div>
                    <div class="time-signature-buttons">
                        <button class="time-sig-btn" data-signature="2">2/4</button>
                        <button class="time-sig-btn" data-signature="3">3/4</button>
                        <button class="time-sig-btn active" data-signature="4">4/4</button>
                        <button class="time-sig-btn" data-signature="6">6/8</button>
                    </div>
                </div>
                
                <div class="beat-indicators" id="beat-indicators">
                    <!-- Beat indicators will be generated here -->
                </div>
                
                <div class="metronome-controls">
                    <button class="metronome-btn start" id="metronome-start-btn">▶️ Start</button>
                    <button class="metronome-btn stop" id="metronome-stop-btn">⏹️ Stop</button>
                </div>
            </div>
        </div>

        <!-- Page 7: Strumming Patterns -->
        <div id="strumming-page" class="page">
            <h2 class="page-title">🎸 Strumming Patterns</h2>
            <p class="page-subtitle">🎵 Master essential strumming patterns for different musical styles and genres 🎵</p>
            
            <div class="legend">
                <h3>🎼 Pattern Notation</h3>
                <div class="legend-items">
                    <div class="legend-item">
                        <span class="legend-symbol strum-down">D</span>
                        <span>Down Strum</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-symbol strum-up">U</span>
                        <span>Up Strum</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-symbol strum-mute">X</span>
                        <span>Muted Strum</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-symbol strum-rest">-</span>
                        <span>Rest</span>
                    </div>
                </div>
            </div>

            <div class="filter-controls">
                <button class="filter-btn active" data-filter="all">✨ All Patterns</button>
                <button class="filter-btn" data-filter="beginner">🌱 Beginner</button>
                <button class="filter-btn" data-filter="intermediate">🎸 Intermediate</button>
                <button class="filter-btn" data-filter="advanced">⭐ Advanced</button>
            </div>
            
            <div class="strumming-patterns-grid" id="strumming-patterns-grid">
                <!-- Strumming patterns will be generated here -->
            </div>
        </div>

        <!-- Page 8: Tab Tutorial -->
        <div id="tab-tutorial-page" class="page">
            <h2 class="page-title">📝 Guitar Tablature Tutorial</h2>
            <p class="page-subtitle">🎼 Master the art of reading and understanding guitar tablature with interactive lessons 🎼</p>
            
            <div class="tab-tutorial-nav">
                <button class="tab-nav-btn active" data-section="tutorial">📚 Interactive Tutorial</button>
                <button class="tab-nav-btn" data-section="exercises">🏃 Practice Exercises</button>
                <button class="tab-nav-btn" data-section="reference">📖 Reference Guide</button>
            </div>

            <!-- Tutorial Section -->
            <div id="tutorial-section" class="tab-section active">
                <div class="lesson-container">
                    <div class="lesson-header">
                        <h3 class="lesson-title">🎼 Learn Guitar Tablature</h3>
                        <p class="lesson-subtitle">Step-by-step interactive lessons to master tab reading</p>
                    </div>

                    <!-- Lesson 1: Basics -->
                    <div class="lesson-content active" id="lesson-1">
                        <h4>📝 What is Guitar Tablature?</h4>
                        <p>Guitar tablature (or "tab") is a simple way to read music specifically for guitar. Instead of traditional musical notes, it uses numbers on lines that represent your guitar strings.</p>
                        
                        <div class="tab-staff">
                            <div class="tab-lines">
                                <div class="tab-labels">
                                    <span>E</span>
                                    <span>B</span>
                                    <span>G</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>E</span>
                                </div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🎸 The Six Lines</h4>
                            <p>Each line represents a guitar string. The top line is the high E string (1st string), and the bottom line is the low E string (6th string). This mirrors how you see the strings when looking down at your guitar.</p>
                        </div>
                    </div>

                    <!-- Lesson 2: Numbers -->
                    <div class="lesson-content" id="lesson-2">
                        <h4>🔢 Understanding the Numbers</h4>
                        <p>Numbers on the lines tell you which fret to press. 0 means play the open string (no fret pressed).</p>
                        
                        <div class="tab-staff">
                            <div class="tab-lines">
                                <div class="tab-labels">
                                    <span>E</span>
                                    <span>B</span>
                                    <span>G</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>E</span>
                                </div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-note" style="left: 100px; top: 165px;">0</div>
                                <div class="tab-note" style="left: 200px; top: 132px;">3</div>
                                <div class="tab-note" style="left: 300px; top: 99px;">2</div>
                                <div class="tab-note" style="left: 400px; top: 33px;">1</div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🎯 Reading Numbers</h4>
                            <p>In this example: Play open low E string (0), then 3rd fret D string, then 2nd fret G string, then 1st fret B string. Click the numbers above to hear how they should sound!</p>
                        </div>
                    </div>

                    <!-- Lesson 3: Timing -->
                    <div class="lesson-content" id="lesson-3">
                        <h4>⏰ Reading from Left to Right</h4>
                        <p>Just like reading text, you read tablature from left to right. The spacing between numbers indicates timing.</p>
                        
                        <div class="tab-staff">
                            <div class="tab-lines">
                                <div class="tab-labels">
                                    <span>E</span>
                                    <span>B</span>
                                    <span>G</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>E</span>
                                </div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-note" style="left: 80px; top: 165px;">3</div>
                                <div class="tab-note" style="left: 160px; top: 165px;">3</div>
                                <div class="tab-note" style="left: 280px; top: 132px;">0</div>
                                <div class="tab-note" style="left: 400px; top: 132px;">2</div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>📏 Spacing Matters</h4>
                            <p>Close spacing = play quickly. Wide spacing = longer notes or pauses. The spacing gives you a visual sense of rhythm.</p>
                        </div>
                    </div>

                    <!-- Lesson 4: Chords -->
                    <div class="lesson-content" id="lesson-4">
                        <h4>🎵 Playing Chords in Tab</h4>
                        <p>When numbers are stacked vertically, play all those notes at the same time to form a chord.</p>
                        
                        <div class="tab-staff">
                            <div class="tab-lines">
                                <div class="tab-labels">
                                    <span>E</span>
                                    <span>B</span>
                                    <span>G</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>E</span>
                                </div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-note" style="left: 150px; top: 0px;">0</div>
                                <div class="tab-note" style="left: 150px; top: 33px;">1</div>
                                <div class="tab-note" style="left: 150px; top: 66px;">0</div>
                                <div class="tab-note" style="left: 150px; top: 99px;">2</div>
                                <div class="tab-note" style="left: 150px; top: 132px;">3</div>
                                <div class="tab-note" style="left: 150px; top: 165px;">x</div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🎸 C Major Chord</h4>
                            <p>This shows a C major chord. The 'x' means don't play that string. All other numbers should be pressed and strummed together.</p>
                        </div>
                    </div>

                    <!-- Lesson 5: Advanced Symbols -->
                    <div class="lesson-content" id="lesson-5">
                        <h4>🎸 Special Techniques & Symbols</h4>
                        <p>Guitar tablature uses special symbols to show advanced playing techniques like bends, slides, and hammer-ons.</p>
                        
                        <div class="tab-staff">
                            <div class="tab-lines">
                                <div class="tab-labels">
                                    <span>E</span>
                                    <span>B</span>
                                    <span>G</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>E</span>
                                </div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div style="position: absolute; left: 80px; top: 99px; font-family: 'Courier New', monospace; font-size: 1.2rem; color: var(--primary-color); font-weight: bold;">3h5</div>
                                <div style="position: absolute; left: 180px; top: 99px; font-family: 'Courier New', monospace; font-size: 1.2rem; color: var(--primary-color); font-weight: bold;">7p5</div>
                                <div style="position: absolute; left: 280px; top: 99px; font-family: 'Courier New', monospace; font-size: 1.2rem; color: var(--primary-color); font-weight: bold;">3/7</div>
                                <div style="position: absolute; left: 380px; top: 99px; font-family: 'Courier New', monospace; font-size: 1.2rem; color: var(--primary-color); font-weight: bold;">5b7</div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🔥 Technique Symbols</h4>
                            <p><strong>h</strong> = hammer-on (3h5 = fret 3, hammer to 5)<br>
                            <strong>p</strong> = pull-off (7p5 = fret 7, pull to 5)<br>
                            <strong>/</strong> = slide up (3/7 = slide from 3 to 7)<br>
                            <strong>b</strong> = bend (5b7 = bend 5th fret to 7th fret pitch)</p>
                        </div>
                    </div>

                    <!-- Lesson 6: Rhythm Notation -->
                    <div class="lesson-content" id="lesson-6">
                        <h4>⏰ Understanding Rhythm in Tabs</h4>
                        <p>More detailed tabs include rhythm notation above the fret numbers to show exactly when to play each note.</p>
                        
                        <div class="tab-staff">
                            <div style="position: relative; height: 280px;">
                                <div style="position: absolute; top: 0; left: 0; right: 0; height: 40px; display: flex; justify-content: space-around; align-items: center; font-family: 'Courier New', monospace; color: var(--secondary-color); font-size: 0.9rem; border-bottom: 1px solid var(--border-color);">
                                    <span>q</span><span>q</span><span>h</span><span>e</span><span>e</span><span>q</span>
                                </div>
                                <div style="position: absolute; top: 50px; left: 0; right: 0; height: 40px; display: flex; justify-content: space-around; align-items: center; font-family: 'Courier New', monospace; color: var(--text-color); font-size: 1.1rem; border-bottom: 1px solid var(--border-color);">
                                    <span>1</span><span>&</span><span>2</span><span>&</span><span>3</span><span>&</span><span>4</span><span>&</span>
                                </div>
                                <div class="tab-lines" style="position: absolute; top: 100px;">
                                    <div class="tab-labels">
                                        <span>E</span>
                                        <span>B</span>
                                        <span>G</span>
                                        <span>D</span>
                                        <span>A</span>
                                        <span>E</span>
                                    </div>
                                    <div class="tab-line"></div>
                                    <div class="tab-line"></div>
                                    <div class="tab-line"></div>
                                    <div class="tab-line"></div>
                                    <div class="tab-line"></div>
                                    <div class="tab-line"></div>
                                    <div class="tab-note" style="left: 50px; top: 165px;">0</div>
                                    <div class="tab-note" style="left: 150px; top: 132px;">2</div>
                                    <div class="tab-note" style="left: 250px; top: 99px;">3</div>
                                    <div class="tab-note" style="left: 350px; top: 66px;">2</div>
                                    <div class="tab-note" style="left: 400px; top: 33px;">0</div>
                                    <div class="tab-note" style="left: 500px; top: 0px;">3</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🎼 Rhythm Symbols</h4>
                            <p><strong>q</strong> = quarter note, <strong>h</strong> = half note, <strong>e</strong> = eighth note<br>
                            The numbers 1, 2, 3, 4 show the main beats, and "&" shows the off-beats.</p>
                        </div>
                    </div>

                    <!-- Lesson 7: Complex Patterns -->
                    <div class="lesson-content" id="lesson-7">
                        <h4>🎯 Reading Complex Patterns</h4>
                        <p>Advanced tabs combine single notes, chords, and techniques to create complex musical patterns.</p>
                        
                        <div class="tab-staff">
                            <div class="tab-lines">
                                <div class="tab-labels">
                                    <span>E</span>
                                    <span>B</span>
                                    <span>G</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>E</span>
                                </div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <div class="tab-line"></div>
                                <!-- Arpeggio pattern -->
                                <div class="tab-note" style="left: 80px; top: 165px;">3</div>
                                <div class="tab-note" style="left: 140px; top: 132px;">2</div>
                                <div class="tab-note" style="left: 200px; top: 99px;">0</div>
                                <div class="tab-note" style="left: 260px; top: 66px;">0</div>
                                <div class="tab-note" style="left: 320px; top: 33px;">1</div>
                                <div class="tab-note" style="left: 380px; top: 0px;">0</div>
                                <!-- Add some technique symbols -->
                                <div style="position: absolute; left: 440px; top: 99px; font-family: 'Courier New', monospace; font-size: 1.1rem; color: var(--primary-color); font-weight: bold;">2h4</div>
                                <div style="position: absolute; left: 520px; top: 33px; font-family: 'Courier New', monospace; font-size: 1.1rem; color: var(--primary-color); font-weight: bold;">3~</div>
                            </div>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🎵 Arpeggio Pattern</h4>
                            <p>This shows a C major arpeggio (playing chord notes individually) followed by a hammer-on (2h4) and vibrato (3~). Practice playing each note cleanly, one after another.</p>
                        </div>
                    </div>

                    <!-- Lesson 8: Tips & Practice -->
                    <div class="lesson-content" id="lesson-8">
                        <h4>🎓 Mastering Tab Reading</h4>
                        <p>Congratulations! You now understand the fundamentals of guitar tablature. Here are some final tips for becoming proficient.</p>
                        
                        <div class="tab-explanation">
                            <h4>📚 Practice Tips</h4>
                            <p><strong>Start Slow:</strong> Always read tabs slowly at first. Speed comes with familiarity.<br><br>
                            <strong>Use a Metronome:</strong> Practice with steady timing to develop good rhythm.<br><br>
                            <strong>Count Out Loud:</strong> Say "1, 2, 3, 4" while playing to internalize timing.<br><br>
                            <strong>Practice Daily:</strong> Even 10 minutes of tab reading practice daily will improve your skills.<br><br>
                            <strong>Learn Songs:</strong> Apply your tab reading skills to actual songs you enjoy.</p>
                        </div>
                        
                        <div class="tab-explanation">
                            <h4>🚀 Next Steps</h4>
                            <p><strong>Standard Notation:</strong> Consider learning traditional music notation alongside tabs.<br><br>
                            <strong>Ear Training:</strong> Try to play songs by ear, then check with tabs.<br><br>
                            <strong>Different Styles:</strong> Explore tabs for various music genres to see different techniques.<br><br>
                            <strong>Create Your Own:</strong> Write out simple melodies or chord progressions in tab format.</p>
                        </div>
                    </div>

                    <div class="lesson-navigation">
                        <button class="lesson-nav-btn" id="prev-lesson" disabled>
                            ← Previous
                        </button>
                        <div class="lesson-progress">
                            <span class="progress-text">Lesson <span id="current-lesson">1</span> of <span id="total-lessons">4</span></span>
                            <div class="progress-dots" id="progress-dots">
                                <div class="progress-dot active"></div>
                                <div class="progress-dot"></div>
                                <div class="progress-dot"></div>
                                <div class="progress-dot"></div>
                            </div>
                        </div>
                        <button class="lesson-nav-btn" id="next-lesson">
                            Next →
                        </button>
                    </div>
                </div>
            </div>

            <!-- Exercises Section -->
            <div id="exercises-section" class="tab-section">
                <div class="exercise-container">
                    <div class="exercise-header">
                        <h3 class="exercise-title">🏃 Single Note Reading</h3>
                        <span class="exercise-difficulty beginner">Beginner</span>
                    </div>
                    
                    <p>Practice reading single notes. Click the correct fret number for each highlighted note.</p>
                    
                    <div class="tab-staff" id="exercise-1-staff">
                        <div class="tab-lines" style="position: relative; height: 240px;">
                            <div class="tab-labels">
                                <span>E</span>
                                <span>B</span>
                                <span>G</span>
                                <span>D</span>
                                <span>A</span>
                                <span>E</span>
                            </div>
                            <!-- String lines that extend across the full width -->
                            <div class="tab-line" style="left: 0; right: 0; width: 100%;"></div>
                            <div class="tab-line" style="left: 0; right: 0; width: 100%;"></div>
                            <div class="tab-line" style="left: 0; right: 0; width: 100%;"></div>
                            <div class="tab-line" style="left: 0; right: 0; width: 100%;"></div>
                            <div class="tab-line" style="left: 0; right: 0; width: 100%;"></div>
                            <div class="tab-line" style="left: 0; right: 0; width: 100%;"></div>
                            <!-- Vertical fret lines -->
                            <div class="fret-line" style="position: absolute; top: 0; bottom: 0; width: 2px; height: 100%; background: var(--fret-color); left: 15%; border-radius: 1px;"></div>
                            <div class="fret-line" style="position: absolute; top: 0; bottom: 0; width: 2px; height: 100%; background: var(--fret-color); left: 30%; border-radius: 1px;"></div>
                            <div class="fret-line" style="position: absolute; top: 0; bottom: 0; width: 2px; height: 100%; background: var(--fret-color); left: 45%; border-radius: 1px;"></div>
                            <div class="fret-line" style="position: absolute; top: 0; bottom: 0; width: 2px; height: 100%; background: var(--fret-color); left: 60%; border-radius: 1px;"></div>
                            <div class="fret-line" style="position: absolute; top: 0; bottom: 0; width: 2px; height: 100%; background: var(--fret-color); left: 75%; border-radius: 1px;"></div>
                            <!-- Add fret numbers -->
                            <div class="fret-numbers" style="position: absolute; left: 0; bottom: -25px; display: flex; color: var(--secondary-color); font-size: 0.9rem; font-weight: bold; width: 100%;">
                                <span style="position: absolute; left: 7.5%;">1</span>
                                <span style="position: absolute; left: 22.5%;">2</span>
                                <span style="position: absolute; left: 37.5%;">3</span>
                                <span style="position: absolute; left: 52.5%;">4</span>
                                <span style="position: absolute; left: 67.5%;">5</span>
                            </div>
                            <div class="tab-note highlighted" style="left: 22.5%; top: 99px;" data-answer="2">?</div>
                        </div>
                    </div>
                    
                    <div class="exercise-controls">
                        <button class="exercise-btn" data-answer="0">0</button>
                        <button class="exercise-btn" data-answer="1">1</button>
                        <button class="exercise-btn" data-answer="2">2</button>
                        <button class="exercise-btn" data-answer="3">3</button>
                        <button class="exercise-btn secondary" id="new-exercise-1">🔄 New Exercise</button>
                    </div>
                    
                    <div class="feedback-display" id="exercise-1-feedback">
                        Click the correct fret number for the highlighted note on the D string.
                    </div>
                </div>

                <div class="exercise-container">
                    <div class="exercise-header">
                        <h3 class="exercise-title">🎵 Chord Reading</h3>
                        <span class="exercise-difficulty intermediate">Intermediate</span>
                    </div>
                    
                    <p>Identify the chord shown in tablature format.</p>
                    
                    <div class="tab-staff" id="exercise-2-staff">
                        <div class="tab-lines" style="position: relative; height: 200px;">
                            <div class="tab-labels">
                                <span>E</span>
                                <span>B</span>
                                <span>G</span>
                                <span>D</span>
                                <span>A</span>
                                <span>E</span>
                            </div>
                            <div class="tab-line"></div>
                            <div class="tab-line"></div>
                            <div class="tab-line"></div>
                            <div class="tab-line"></div>
                            <div class="tab-line"></div>
                            <div class="tab-line"></div>
                            <div class="tab-note highlighted" style="left: 150px; top: 0px;">0</div>
                            <div class="tab-note highlighted" style="left: 150px; top: 33px;">0</div>
                            <div class="tab-note highlighted" style="left: 150px; top: 66px;">0</div>
                            <div class="tab-note highlighted" style="left: 150px; top: 99px;">2</div>
                            <div class="tab-note highlighted" style="left: 150px; top: 132px;">2</div>
                            <div class="tab-note highlighted" style="left: 150px; top: 165px;">0</div>
                        </div>
                    </div>
                    
                    <div class="exercise-controls">
                        <button class="exercise-btn" data-chord="Em">Em</button>
                        <button class="exercise-btn" data-chord="Am">Am</button>
                        <button class="exercise-btn" data-chord="C">C</button>
                        <button class="exercise-btn" data-chord="G">G</button>
                        <button class="exercise-btn secondary" id="new-exercise-2">🔄 New Chord</button>
                    </div>
                    
                    <div class="feedback-display" id="exercise-2-feedback">
                        What chord is shown in the tablature above?
                    </div>
                </div>

                <div class="exercise-container">
                    <div class="exercise-header">
                        <h3 class="exercise-title">🎼 Symbol Recognition</h3>
                        <span class="exercise-difficulty advanced">Advanced</span>
                    </div>
                    
                    <p>Identify the meaning of special symbols in tablature.</p>
                    
                    <div class="tab-staff" id="exercise-3-staff">
                        <div style="text-align: center; font-family: 'Courier New', monospace; font-size: 2rem; padding: 2rem; background: var(--bg-color); border-radius: 12px; margin: 1rem 0;">
                            <span style="color: var(--primary-color); font-weight: bold;">3h5</span>
                        </div>
                    </div>
                    
                    <div class="exercise-controls">
                        <button class="exercise-btn" data-symbol="hammer-on">Hammer-on</button>
                        <button class="exercise-btn" data-symbol="pull-off">Pull-off</button>
                        <button class="exercise-btn" data-symbol="slide">Slide up</button>
                        <button class="exercise-btn" data-symbol="bend">Bend</button>
                        <button class="exercise-btn secondary" id="new-exercise-3">🔄 New Symbol</button>
                    </div>
                    
                    <div class="feedback-display" id="exercise-3-feedback">
                        What does the symbol 'h' represent in tablature?
                    </div>
                </div>
            </div>

            <!-- Reference Section -->
            <div id="reference-section" class="tab-section">
                <div class="reference-grid">
                    <div class="reference-card">
                        <h3>🎼 Basic Symbols</h3>
                        <ul class="symbol-list">
                            <li class="symbol-item">
                                <span class="symbol-notation">0</span>
                                <span class="symbol-description">Open string (no fret)</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">1-24</span>
                                <span class="symbol-description">Fret number to press</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">x</span>
                                <span class="symbol-description">Don't play this string</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">|</span>
                                <span class="symbol-description">Bar line (measure)</span>
                            </li>
                        </ul>
                    </div>

                    <div class="reference-card">
                        <h3>🎵 Techniques</h3>
                        <ul class="symbol-list">
                            <li class="symbol-item">
                                <span class="symbol-notation">h</span>
                                <span class="symbol-description">Hammer-on</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">p</span>
                                <span class="symbol-description">Pull-off</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">/</span>
                                <span class="symbol-description">Slide up</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">\</span>
                                <span class="symbol-description">Slide down</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">b</span>
                                <span class="symbol-description">Bend</span>
                            </li>
                        </ul>
                    </div>

                    <div class="reference-card">
                        <h3>🎸 Advanced Symbols</h3>
                        <ul class="symbol-list">
                            <li class="symbol-item">
                                <span class="symbol-notation">~</span>
                                <span class="symbol-description">Vibrato</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">pm</span>
                                <span class="symbol-description">Palm mute</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">^</span>
                                <span class="symbol-description">Bend up</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">r</span>
                                <span class="symbol-description">Release bend</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">()</span>
                                <span class="symbol-description">Ghost note</span>
                            </li>
                        </ul>
                    </div>

                    <div class="reference-card">
                        <h3>⏰ Timing Symbols</h3>
                        <ul class="symbol-list">
                            <li class="symbol-item">
                                <span class="symbol-notation">w</span>
                                <span class="symbol-description">Whole note</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">h</span>
                                <span class="symbol-description">Half note</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">q</span>
                                <span class="symbol-description">Quarter note</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">e</span>
                                <span class="symbol-description">Eighth note</span>
                            </li>
                            <li class="symbol-item">
                                <span class="symbol-notation">s</span>
                                <span class="symbol-description">Sixteenth note</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="chord-tab-link">
                    <h3>🔗 Connect with Chord Diagrams</h3>
                    <p>See how tablature relates to the chord diagrams you've learned</p>
                    <button onclick="window.switchToLibraryPage()">View Chord Library</button>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="footer">
        <p>🎵 Designed with passion for music 🎵</p>
    </footer>
    <script>
        // Make switchToLibraryPage globally available first
        window.switchToLibraryPage = function() {
            const libraryNavLink = document.querySelector('[data-page="library-page"]');
            if (libraryNavLink) {
                libraryNavLink.click();
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            // --- DARK MODE SETUP ---
            const darkModeToggle = document.getElementById('darkModeToggle');
            let isDarkMode = false;
            // Check for user's preferred color scheme
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                isDarkMode = true;
                document.documentElement.classList.add('dark');
            }
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    isDarkMode = true;
                    document.documentElement.classList.add('dark');
                } else {
                    isDarkMode = false;
                    document.documentElement.classList.remove('dark');
                }
                updateDarkModeToggle();
            });
            function updateDarkModeToggle() {
                if (isDarkMode) {
                    darkModeToggle.innerHTML = '<span class="toggle-icon">☀️</span><span>Light</span>';
                } else {
                    darkModeToggle.innerHTML = '<span class="toggle-icon">🌙</span><span>Dark</span>';
                }
            }
            function updateDarkMode() {
                if (isDarkMode) {
                    document.documentElement.classList.add('dark');
                    darkModeToggle.innerHTML = '<span class="toggle-icon">☀️</span><span>Light</span>';
                } else {
                    document.documentElement.classList.remove('dark');
                    darkModeToggle.innerHTML = '<span class="toggle-icon">🌙</span><span>Dark</span>';
                }
            }
            darkModeToggle.addEventListener('click', () => {
                isDarkMode = !isDarkMode;
                updateDarkMode();
            });
            // Initialize dark mode
            updateDarkMode();
            // --- EDIT HERE TO ADD NEW CHORDS ---
            const chordData = {
                'C': { 
                    'Major': { frets: ['x', 3, 2, 0, 1, 0], fingers: ['x', 3, 2, null, 1, null] },
                    'Minor': { frets: ['x', 'x', 5, 5, 4, 3], fingers: ['x', 'x', 3, 4, 2, 1] },
                    '7th': { frets: ['x', 3, 2, 3, 1, 0], fingers: ['x', 3, 2, 4, 1, null] },
                    'sus4': { frets: ['x', 3, 3, 0, 1, 'x'], fingers: ['x', 3, 4, null, 1, 'x'] },
                    'aug': { frets: ['x', 'x', 2, 1, 1, 0], fingers: ['x', 'x', 3, 1, 2, null] },
                    'dim': { frets: ['x', 'x', 1, 2, 1, 2], fingers: ['x', 'x', 1, 3, 2, 4] }
                },
                'D': { 
                    'Major': { frets: ['x', 0, 0, 2, 3, 2], fingers: ['x', null, null, 1, 3, 2] },
                    'Minor': { frets: ['x', 0, 0, 2, 3, 1], fingers: ['x', null, null, 2, 3, 1] },
                    '7th': { frets: ['x', 0, 0, 2, 1, 2], fingers: ['x', null, null, 2, 1, 3] },
                    'sus4': { frets: ['x', 'x', 0, 2, 3, 3], fingers: ['x', 'x', null, 1, 2, 3] },
                    'aug': { frets: ['x', 'x', 5, 4, 4, 3], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 0, 1, 0, 1], fingers: ['x', 'x', null, 1, null, 2] }
                },
                'E': { 
                    'Major': { frets: [0, 2, 2, 1, 0, 0], fingers: [null, 2, 3, 1, null, null] },
                    'Minor': { frets: [0, 2, 2, 0, 0, 0], fingers: [null, 2, 3, null, null, null] },
                    '7th': { frets: [0, 2, 0, 1, 0, 0], fingers: [null, 2, null, 1, null, null] },
                    'sus4': { frets: [0, 2, 2, 2, 0, 0], fingers: [null, 1, 2, 3, null, null] },
                    'aug': { frets: ['x', 'x', 2, 1, 1, 0], fingers: ['x', 'x', 3, 1, 2, null] },
                    'dim': { frets: ['x', 'x', 2, 3, 2, 3], fingers: ['x', 'x', 1, 3, 2, 4] }
                },
                'G': { 
                    'Major': { frets: [3, 2, 0, 0, 0, 3], fingers: [2, 1, null, null, null, 3] },
                    'Minor': { frets: ['x', 'x', 5, 3, 3, 3], fingers: ['x', 'x', 3, 1, 1, 1] },
                    '7th': { frets: [3, 2, 0, 0, 0, 1], fingers: [3, 2, null, null, null, 1] },
                    'sus4': { frets: [3, 3, 0, 0, 1, 3], fingers: [2, 3, null, null, 1, 4] },
                    'aug': { frets: ['x', 'x', 5, 4, 4, 3], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 2, 3, 2, 3], fingers: ['x', 'x', 1, 3, 2, 4] }
                },
                'A': { 
                    'Major': { frets: ['x', 0, 2, 2, 2, 0], fingers: ['x', null, 1, 2, 3, null] },
                    'Minor': { frets: ['x', 0, 2, 2, 1, 0], fingers: ['x', null, 2, 3, 1, null] },
                    '7th': { frets: [0, 0, 2, 0, 2, 0], fingers: [null, null, 1, null, 2, null] },
                    'sus4': { frets: ['x', 0, 2, 2, 3, 0], fingers: ['x', null, 1, 2, 4, null] },
                    'aug': { frets: ['x', 'x', 3, 2, 2, 1], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 1, 2, 1, 2], fingers: ['x', 'x', 1, 3, 2, 4] }
                },
                'F': { 
                    'Major': { frets: ['x', 'x', 3, 2, 1, 1], fingers: ['x', 'x', 3, 2, 1, 1] },
                    'Minor': { frets: ['x', 'x', 3, 1, 1, 1], fingers: ['x', 'x', 3, 1, 1, 1] },
                    '7th': { frets: ['x', 'x', 1, 2, 1, 1], fingers: ['x', 'x', 1, 2, 1, 1] },
                    'sus4': { frets: [1, 3, 3, 3, 1, 1], fingers: [1, 2, 3, 4, 1, 1] },
                    'aug': { frets: ['x', 'x', 3, 2, 2, 1], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 0, 1, 0, 1], fingers: ['x', 'x', null, 1, null, 2] }
                },
                'B': { 
                    'Major': { frets: ['x', 'x', 4, 4, 4, 2], fingers: ['x', 'x', 2, 3, 4, 1] },
                    'Minor': { frets: ['x', 'x', 4, 4, 3, 2], fingers: ['x', 'x', 3, 4, 2, 1] },
                    '7th': { frets: ['x', 2, 1, 2, 0, 2], fingers: ['x', 2, 1, 3, null, 4] },
                    'sus4': { frets: ['x', 2, 4, 4, 5, 2], fingers: ['x', 1, 2, 3, 4, 1] },
                    'aug': { frets: ['x', 'x', 5, 4, 4, 3], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 0, 1, 0, 1], fingers: ['x', 'x', 0, 1, 0, 2] }
                },
                'C#': { 
                    'Major': { frets: ['x', 'x', 3, 1, 2, 1], fingers: ['x', 'x', 3, 1, 2, 1] },
                    'Minor': { frets: ['x', 'x', 2, 1, 2, 0], fingers: ['x', 'x', 2, 1, 3, null] },
                    '7th': { frets: ['x', 4, 3, 4, 2, 'x'], fingers: ['x', 3, 2, 4, 1, 'x'] },
                    'sus4': { frets: ['x', 4, 6, 6, 7, 4], fingers: ['x', 1, 2, 3, 4, 1] },
                    'aug': { frets: ['x', 'x', 3, 2, 2, 1], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 2, 3, 2, 3], fingers: ['x', 'x', 1, 3, 2, 4] }
                },
                'Eb/D#': { 
                    'Major': { frets: ['x', 'x', 5, 3, 4, 3], fingers: ['x', 'x', 3, 1, 2, 1] },
                    'Minor': { frets: ['x', 'x', 4, 3, 4, 2], fingers: ['x', 'x', 3, 2, 4, 1] },
                    '7th': { frets: ['x', 'x', 1, 3, 2, 3], fingers: ['x', 'x', 1, 3, 2, 4] },
                    'sus4': { frets: ['x', 'x', 1, 3, 4, 4], fingers: ['x', 'x', 1, 3, 4, 4] },
                    'aug': { frets: ['x', 'x', 5, 4, 4, 3], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 1, 2, 1, 2], fingers: ['x', 'x', 1, 3, 2, 4] }
                },
                'F#': { 
                    'Major': { frets: ['x', 'x', 4, 3, 2, 2], fingers: ['x', 'x', 3, 2, 1, 1] },
                    'Minor': { frets: ['x', 'x', 4, 2, 2, 2], fingers: ['x', 'x', 3, 1, 1, 1] },
                    '7th': { frets: ['x', 'x', 2, 3, 2, 2], fingers: ['x', 'x', 1, 2, 1, 1] },
                    'sus4': { frets: [2, 4, 4, 4, 2, 2], fingers: [1, 2, 3, 4, 1, 1] },
                    'aug': { frets: ['x', 'x', 4, 3, 3, 2], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: [2, 3, 4, 2, 'x', 'x'], fingers: [1, 2, 3, 1, 'x', 'x'] }
                },
                'G#/Ab': { 
                    'Major': { frets: ['x', 'x', 1, 1, 1, 4], fingers: ['x', 'x', 1, 1, 1, 4] },
                    'Minor': { frets: ['x', 'x', 6, 4, 4, 4], fingers: ['x', 'x', 3, 1, 1, 1] },
                    '7th': { frets: ['x', 'x', 1, 1, 1, 2], fingers: ['x', 'x', 1, 1, 1, 3] },
                    'sus4': { frets: [4, 6, 6, 6, 4, 4], fingers: [1, 2, 3, 4, 1, 1] },
                    'aug': { frets: ['x', 'x', 2, 1, 1, 0], fingers: ['x', 'x', 3, 1, 2, null] },
                    'dim': { frets: ['x', 'x', 0, 1, 0, 1], fingers: ['x', 'x', null, 1, null, 2] }
                },
                'A#/Bb': { 
                    'Major': { frets: ['x', 'x', 3, 3, 3, 1], fingers: ['x', 'x', 2, 3, 4, 1] },
                    'Minor': { frets: ['x', 'x', 3, 3, 2, 1], fingers: ['x', 'x', 3, 4, 2, 1] },
                    '7th': { frets: ['x', 'x', 3, 3, 3, 4], fingers: ['x', 'x', 1, 1, 1, 3] },
                    'sus4': { frets: ['x', 1, 3, 3, 4, 1], fingers: ['x', 1, 2, 3, 4, 1] },
                    'aug': { frets: ['x', 'x', 4, 3, 3, 2], fingers: ['x', 'x', 4, 2, 3, 1] },
                    'dim': { frets: ['x', 'x', 2, 3, 2, 3], fingers: ['x', 'x', 1, 3, 2, 4] }
                }
            };
            
            // --- EDIT HERE TO ADD NEW SONGS ---
            const songData = [
		{ title: "Viva La Vida", artist: "Coldplay", chords: ["C", "D", "G", "Em"]},
		{ title: "New Song", artist: "Artist Name", chords: ["C", "G", "Am", "F"] }
                // ADD MORE SONGS HERE - Example:
                // { title: "New Song", artist: "Artist Name", chords: ["C", "G", "Am", "F"] },
            ];

            // --- STRUMMING PATTERNS DATA ---
            const strummingPatterns = [
                {
                    name: "Basic Down",
                    pattern: "D - D - D - D -",
                    timeSignature: "4/4",
                    difficulty: "beginner",
                    description: "The most basic strumming pattern. Perfect for beginners learning chord changes.",
                    genre: "Folk, Country"
                },
                {
                    name: "Down-Up",
                    pattern: "D U D U D U D U",
                    timeSignature: "4/4",
                    difficulty: "beginner",
                    description: "Essential alternating pattern. Forms the foundation of most strumming.",
                    genre: "Pop, Rock"
                },
                {
                    name: "Old Faithful",
                    pattern: "D - D U - U D U",
                    timeSignature: "4/4",
                    difficulty: "beginner",
                    description: "Classic folk pattern used in countless songs.",
                    genre: "Folk, Country"
                },
                {
                    name: "Pop Standard",
                    pattern: "D - D U D U D U",
                    timeSignature: "4/4",
                    difficulty: "beginner",
                    description: "Very common in modern pop music.",
                    genre: "Pop, Contemporary"
                },
                {
                    name: "Country Waltz",
                    pattern: "D - - D - - D - -",
                    timeSignature: "3/4",
                    difficulty: "beginner",
                    description: "Traditional waltz pattern for country and folk.",
                    genre: "Country, Folk"
                },
                {
                    name: "Ballad Strum",
                    pattern: "D - - - D - - -",
                    timeSignature: "4/4",
                    difficulty: "beginner",
                    description: "Slow, emotional pattern for ballads.",
                    genre: "Ballad, Folk"
                },
                {
                    name: "Island Rhythm",
                    pattern: "D - D U - U - U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Relaxed pattern with island feel.",
                    genre: "Reggae, Island"
                },
                {
                    name: "Reggae Basic",
                    pattern: "- - D U - - D U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Classic reggae off-beat emphasis.",
                    genre: "Reggae"
                },
                {
                    name: "Folk Finger",
                    pattern: "D - D - D U D U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Common in fingerpicking-style strumming.",
                    genre: "Folk, Indie"
                },
                {
                    name: "Punk Power",
                    pattern: "D D D D D D D D",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Fast, aggressive downstrokes for punk.",
                    genre: "Punk, Metal"
                },
                {
                    name: "Swing Feel",
                    pattern: "D - D - D U - U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Swung eighth notes for jazz feel.",
                    genre: "Jazz, Swing"
                },
                {
                    name: "Syncopated",
                    pattern: "D - D U D - D U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Off-beat emphasis creates syncopation.",
                    genre: "Funk, R&B"
                },
                {
                    name: "Latin Bossa",
                    pattern: "D - D U - D - U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Smooth bossa nova style rhythm.",
                    genre: "Latin, Bossa Nova"
                },
                {
                    name: "Shuffle",
                    pattern: "D - - D U - D U",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Shuffle rhythm with triplet feel.",
                    genre: "Blues, Country"
                },
                {
                    name: "Muted Funk",
                    pattern: "D X D U X U D U",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "Percussive pattern with muted strums.",
                    genre: "Funk, R&B"
                },
                {
                    name: "Complex Pop",
                    pattern: "D U D - D U - U",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "More complex pattern for advanced songs.",
                    genre: "Pop, Alternative"
                },
                {
                    name: "Flamenco",
                    pattern: "D U D U D U - U",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "Spanish-inspired rapid strumming.",
                    genre: "Flamenco, Spanish"
                },
                {
                    name: "Jazz Comp",
                    pattern: "- - D - - U D -",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "Jazz comping with sparse hits.",
                    genre: "Jazz"
                },
                {
                    name: "Fingerstyle",
                    pattern: "D - - U D - - U",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "Mimics fingerpicking patterns.",
                    genre: "Folk, Classical"
                },
                {
                    name: "Progressive",
                    pattern: "D U D - D U D -",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "Complex rhythm for progressive music.",
                    genre: "Progressive Rock"
                },
                {
                    name: "Waltz Up",
                    pattern: "D U U D U U D U U",
                    timeSignature: "3/4",
                    difficulty: "intermediate",
                    description: "Flowing waltz with upstrokes.",
                    genre: "Folk, Country"
                },
                {
                    name: "6/8 Folk",
                    pattern: "D - - D - U D - - D - U",
                    timeSignature: "6/8",
                    difficulty: "intermediate",
                    description: "Compound time folk pattern.",
                    genre: "Folk, Celtic"
                },
                {
                    name: "Gallop",
                    pattern: "D D U D D U D D U D D U",
                    timeSignature: "4/4",
                    difficulty: "advanced",
                    description: "Fast galloping rhythm pattern.",
                    genre: "Metal, Rock"
                },
                {
                    name: "Calypso",
                    pattern: "D - D U - U D -",
                    timeSignature: "4/4",
                    difficulty: "intermediate",
                    description: "Caribbean calypso rhythm.",
                    genre: "Calypso, Caribbean"
                },
				{
					name: "Advanced 1",
					pattern: "D - D - D U D U",
					timeSignature: "4/4",
					difficulty: "advanced",
					description: "Popular patterns",
					genre: "Popular Music"
				}
            ];
            
            // --- DOM ELEMENTS ---
            const rootNoteSelector = document.getElementById('root-note-selector');
            const chordTypeSelector = document.getElementById('chord-type-selector');
            const chordDisplay = document.getElementById('chord-display');
            const navLinks = document.querySelectorAll('.nav-link');
            const pages = document.querySelectorAll('.page');
            const songListContainer = document.getElementById('song-list');
            const progressStatsContainer = document.getElementById('progress-stats');
            const chordProgressGrid = document.getElementById('chord-progress-grid');
            const progressBarFill = document.getElementById('progress-bar-fill');
            const progressBarText = document.getElementById('progress-bar-text');
            
            // --- PRACTICE TIMER ELEMENTS ---
            const timerDisplay = document.getElementById('timer-display');
            const timerStatus = document.getElementById('timer-status');
            const minutesInput = document.getElementById('minutes-input');
            const secondsInput = document.getElementById('seconds-input');
            const startPauseBtn = document.getElementById('start-pause-btn');
            const resetBtn = document.getElementById('reset-btn');
            const presetButtons = document.querySelectorAll('.preset-btn');

            // --- METRONOME ELEMENTS ---
            const metronomeStatus = document.getElementById('metronome-status');
            const metronomeDisplay = document.getElementById('metronome-bpm-display');
            const bpmSlider = document.getElementById('bpm-slider');
            const bpmInput = document.getElementById('bpm-input');
            const timeSigButtons = document.querySelectorAll('.time-sig-btn');
            const beatIndicators = document.getElementById('beat-indicators');
            const metronomeStartBtn = document.getElementById('metronome-start-btn');
            const metronomeStopBtn = document.getElementById('metronome-stop-btn');

            // --- STRUMMING PATTERNS ELEMENTS ---
            const strummingPatternsGrid = document.getElementById('strumming-patterns-grid');
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            // --- PROGRESS TRACKING ---
            let learnedChords = new Set(); // Stores learned chord keys like "C-Major"
            
            // --- TIMER STATE ---
            let timerInterval = null;
            let timeRemaining = 300; // 5 minutes in seconds
            let isRunning = false;
            let isPaused = false;

            // --- METRONOME STATE ---
            let metronomeInterval = null;
            let isMetronomeRunning = false;
            let currentBpm = 120;
            let currentTimeSignature = 4;
            let currentBeat = 0;
            let audioContext = null;

            // --- STRUMMING PATTERNS STATE ---
            let currentFilter = 'all';
            let activePatternAudio = null;
            
            // --- TAB TUTORIAL STATE ---
            let currentTabSection = 'tutorial';
            let currentLesson = 1;
            let totalLessons = 8;
            const exerciseAnswers = {
                exercise1: { correct: '2', current: null },
                exercise2: { correct: 'Em', current: null },
                exercise3: { correct: 'hammer-on', current: null }
            };
            const exerciseData = {
                exercise1: [
                    { fret: '0', string: 165, answer: '0', description: 'Open low E string' },
                    { fret: '1', string: 165, answer: '1', description: '1st fret low E string' },
                    { fret: '2', string: 165, answer: '2', description: '2nd fret low E string' },
                    { fret: '3', string: 165, answer: '3', description: '3rd fret low E string' },
                    { fret: '5', string: 165, answer: '5', description: '5th fret low E string' },
                    { fret: '0', string: 132, answer: '0', description: 'Open A string' },
                    { fret: '2', string: 132, answer: '2', description: '2nd fret A string' },
                    { fret: '3', string: 132, answer: '3', description: '3rd fret A string' },
                    { fret: '5', string: 132, answer: '5', description: '5th fret A string' },
                    { fret: '7', string: 132, answer: '7', description: '7th fret A string' },
                    { fret: '0', string: 99, answer: '0', description: 'Open D string' },
                    { fret: '2', string: 99, answer: '2', description: '2nd fret D string' },
                    { fret: '3', string: 99, answer: '3', description: '3rd fret D string' },
                    { fret: '4', string: 99, answer: '4', description: '4th fret D string' },
                    { fret: '5', string: 99, answer: '5', description: '5th fret D string' },
                    { fret: '0', string: 66, answer: '0', description: 'Open G string' },
                    { fret: '1', string: 66, answer: '1', description: '1st fret G string' },
                    { fret: '2', string: 66, answer: '2', description: '2nd fret G string' },
                    { fret: '4', string: 66, answer: '4', description: '4th fret G string' },
                    { fret: '5', string: 66, answer: '5', description: '5th fret G string' },
                    { fret: '0', string: 33, answer: '0', description: 'Open B string' },
                    { fret: '1', string: 33, answer: '1', description: '1st fret B string' },
                    { fret: '3', string: 33, answer: '3', description: '3rd fret B string' },
                    { fret: '5', string: 33, answer: '5', description: '5th fret B string' },
                    { fret: '8', string: 33, answer: '8', description: '8th fret B string' },
                    { fret: '0', string: 0, answer: '0', description: 'Open high E string' },
                    { fret: '1', string: 0, answer: '1', description: '1st fret high E string' },
                    { fret: '3', string: 0, answer: '3', description: '3rd fret high E string' },
                    { fret: '5', string: 0, answer: '5', description: '5th fret high E string' },
                    { fret: '7', string: 0, answer: '7', description: '7th fret high E string' },
                    { fret: '12', string: 165, answer: '12', description: '12th fret low E string' },
                    { fret: '12', string: 132, answer: '12', description: '12th fret A string' },
                    { fret: '12', string: 99, answer: '12', description: '12th fret D string' },
                    { fret: '12', string: 66, answer: '12', description: '12th fret G string' },
                    { fret: '12', string: 33, answer: '12', description: '12th fret B string' },
                    { fret: '12', string: 0, answer: '12', description: '12th fret high E string' }
                ],
                exercise2: [
                    { chord: 'Em', frets: [0, 0, 0, 2, 2, 0], answer: 'Em', description: 'E minor chord' },
                    { chord: 'Am', frets: ['x', 0, 2, 2, 1, 0], answer: 'Am', description: 'A minor chord' },
                    { chord: 'C', frets: ['x', 3, 2, 0, 1, 0], answer: 'C', description: 'C major chord' },
                    { chord: 'G', frets: [3, 2, 0, 0, 3, 3], answer: 'G', description: 'G major chord' },
                    { chord: 'D', frets: ['x', 'x', 0, 2, 3, 2], answer: 'D', description: 'D major chord' },
                    { chord: 'A', frets: ['x', 0, 2, 2, 2, 0], answer: 'A', description: 'A major chord' },
                    { chord: 'E', frets: [0, 2, 2, 1, 0, 0], answer: 'E', description: 'E major chord' },
                    { chord: 'Dm', frets: ['x', 'x', 0, 2, 3, 1], answer: 'Dm', description: 'D minor chord' },
                    { chord: 'F', frets: [1, 3, 3, 2, 1, 1], answer: 'F', description: 'F major chord (barre)' },
                    { chord: 'B7', frets: ['x', 2, 1, 2, 0, 2], answer: 'B7', description: 'B7 chord' },
                    { chord: 'G7', frets: [3, 2, 0, 0, 0, 1], answer: 'G7', description: 'G7 chord' },
                    { chord: 'C7', frets: ['x', 3, 2, 3, 1, 0], answer: 'C7', description: 'C7 chord' },
                    { chord: 'A7', frets: ['x', 0, 2, 0, 2, 0], answer: 'A7', description: 'A7 chord' },
                    { chord: 'E7', frets: [0, 2, 0, 1, 0, 0], answer: 'E7', description: 'E7 chord' },
                    { chord: 'D7', frets: ['x', 'x', 0, 2, 1, 2], answer: 'D7', description: 'D7 chord' },
                    { chord: 'Cmaj7', frets: ['x', 3, 2, 0, 0, 0], answer: 'Cmaj7', description: 'C major 7 chord' },
                    { chord: 'Fmaj7', frets: [1, 3, 3, 2, 1, 0], answer: 'Fmaj7', description: 'F major 7 chord' }
                ],
                exercise3: [
                    { symbol: '3h5', description: 'hammer-on from 3rd to 5th fret', answer: 'hammer-on' },
                    { symbol: '5p3', description: 'pull-off from 5th to 3rd fret', answer: 'pull-off' },
                    { symbol: '3/5', description: 'slide up from 3rd to 5th fret', answer: 'slide' },
                    { symbol: '5\\3', description: 'slide down from 5th to 3rd fret', answer: 'slide' },
                    { symbol: '5b7', description: 'bend from 5th fret to 7th fret pitch', answer: 'bend' },
                    { symbol: '7r5', description: 'release bend from 7th back to 5th', answer: 'bend' },
                    { symbol: '3~', description: 'vibrato on 3rd fret', answer: 'vibrato' },
                    { symbol: '(5)', description: 'ghost note on 5th fret', answer: 'ghost' },
                    { symbol: 'pm----', description: 'palm muting technique', answer: 'palm-mute' },
                    { symbol: '2^4', description: 'bend from 2nd fret to 4th fret pitch', answer: 'bend' },
                    { symbol: '0h2h4', description: 'hammer-on sequence 0-2-4', answer: 'hammer-on' },
                    { symbol: '4p2p0', description: 'pull-off sequence 4-2-0', answer: 'pull-off' },
                    { symbol: '3//7', description: 'long slide from 3rd to 7th fret', answer: 'slide' },
                    { symbol: 'x', description: 'muted or dead note', answer: 'mute' },
                    { symbol: '5*', description: 'harmonic at 5th fret', answer: 'harmonic' },
                    { symbol: '12*', description: 'natural harmonic at 12th fret', answer: 'harmonic' },
                    { symbol: 't5', description: 'tapping technique on 5th fret', answer: 'tap' },
                    { symbol: '3v', description: 'vibrato bar dive', answer: 'vibrato-bar' },
                    { symbol: 's', description: 'slap technique', answer: 'slap' },
                    { symbol: 'p', description: 'pop technique (bass)', answer: 'pop' }
                ]
            };
            
            // --- CORE FUNCTIONS ---
            
            /**
             * Creates a visual capo bar across all strings at the nut position
             */
            function createCapoBar(fretboard, isSmall = false, isMini = false) {
                const stringSpacing = isMini ? 40 / 5 : 100 / 5;
                const stringOffset = isMini ? 25 : 0;
                const nutHeight = isMini ? 3 : (isSmall ? 8 : 12);
                const capoHeight = isMini ? 6 : (isSmall ? 14 : 20);
                
                const capoBar = document.createElement('div');
                capoBar.className = 'capo-bar';
                capoBar.style.position = 'absolute';
                capoBar.style.left = `${stringOffset}%`;
                capoBar.style.width = `${5 * stringSpacing}%`;
                capoBar.style.height = `${capoHeight}px`;
                capoBar.style.top = `${nutHeight * 0.5}px`;
                capoBar.style.background = 'linear-gradient(135deg, #2d3748 0%, #4a5568 100%)';
                capoBar.style.borderRadius = `${capoHeight/2}px`;
                capoBar.style.zIndex = '10';
                capoBar.style.border = '2px solid #1a202c';
                capoBar.style.boxShadow = '0 4px 12px rgba(45, 55, 72, 0.6)';
                capoBar.style.transform = 'translateY(-50%)';
                
                // Add capo label
                const capoLabel = document.createElement('div');
                capoLabel.textContent = 'CAPO';
                capoLabel.style.position = 'absolute';
                capoLabel.style.color = 'white';
                capoLabel.style.fontSize = isMini ? '0.6rem' : (isSmall ? '0.7rem' : '0.8rem');
                capoLabel.style.fontWeight = 'bold';
                capoLabel.style.left = '50%';
                capoLabel.style.top = '50%';
                capoLabel.style.transform = 'translate(-50%, -50%)';
                capoLabel.style.textShadow = '0 1px 2px rgba(0,0,0,0.5)';
                capoLabel.style.letterSpacing = '0.5px';
                
                capoBar.appendChild(capoLabel);
                fretboard.appendChild(capoBar);
            }
            
            /**
             * Creates and returns a chord diagram element.
             * @param {string} rootNote - The root note of the chord (e.g., 'G').
             * @param {string} chordType - The type of the chord (e.g., 'Major').
             * @param {object} chord - The chord data object with frets and fingers.
             * @param {boolean} isSmall - Whether this is a small diagram for songs.
             * @param {boolean} isMini - Whether this is a mini diagram for progress page.
             * @returns {HTMLElement} - The complete chord diagram wrapper element.
             */
            function createChordDiagram(rootNote, chordType, chord, isSmall = false, isMini = false) {
                const { frets, fingers } = chord;
                
                const wrapper = document.createElement('div');
                wrapper.className = `chord-diagram-wrapper ${isMini ? 'mini-chord-diagram' : ''}`;
                // Chord name goes first (above diagram)
                const chordNameEl = document.createElement('h3');
                chordNameEl.className = 'chord-guide-name';
                chordNameEl.textContent = `${rootNote} ${chordType}`;
                const diagram = document.createElement('div');
                diagram.className = 'chord-diagram';
                const fretboard = document.createElement('div');
                fretboard.className = 'fretboard';
                const nut = document.createElement('div');
                nut.className = 'nut';
                fretboard.appendChild(nut);
                // Adjust measurements for small and mini diagrams
                const fretSpacing = isMini ? 14.4 : (isSmall ? 36 : 54);
                const nutHeight = isMini ? 3 : (isSmall ? 8 : 12);
                const topOffset = isMini ? 22 : (isSmall ? 35 : 50);
                
                // Calculate capo position and transpose chord
                const nonZeroFrets = frets.filter(f => f !== 'x' && f !== 0).map(f => parseInt(f));
                
                // Only use capo if the chord extends beyond 5 frets
                let capoPosition = 0;
                let shouldUseCapo = false;
                let transposedFrets = frets;
                
                if (nonZeroFrets.length > 0) {
                    const maxFret = Math.max(...nonZeroFrets);
                    
                    // Only use capo if the highest fret is beyond fret 5
                    if (maxFret > 5) {
                        const minFret = Math.min(...nonZeroFrets);
                        capoPosition = minFret;
                        shouldUseCapo = true;
                        
                        // Transpose frets so capo position becomes fret 1
                        transposedFrets = frets.map(fret => {
                            if (fret === 'x' || fret === 0) return fret;
                            const newFret = parseInt(fret) - capoPosition + 1;
                            return newFret <= 0 ? 0 : newFret;
                        });
                    }
                }
                
                // Update nut height for different sizes
                if (isSmall || isMini) {
                    nut.style.height = `${nutHeight}px`;
                }
                
                // For mini diagrams, make nut properly aligned with frets
                if (isMini) {
                    nut.style.width = '100%';
                    nut.style.left = '0%';
                }
                // Always create 5 frets
                for (let i = 0; i < 5; i++) {
                    const fret = document.createElement('div');
                    fret.className = 'fret';
                    fret.style.top = `${(i * fretSpacing) + nutHeight}px`;
                    
                    // For mini diagrams, make frets properly aligned with strings
                    if (isMini) {
                        fret.style.width = '100%';
                        fret.style.left = '0%';
                    }
                    
                    fretboard.appendChild(fret);
                }
                // Create bar chords (barre) first, before individual dots - use original frets for barre detection
                createBarChords(fretboard, frets, fingers, isSmall, shouldUseCapo ? capoPosition : 0, isMini);
                // Adjust string spacing for mini diagrams to make them narrower
                const stringSpacing = isMini ? 40 / 5 : 100 / 5;
                const stringOffset = isMini ? 25 : 0; // Offset to center the strings
                
                transposedFrets.forEach((fretNum, stringIndex) => {
                    const string = document.createElement('div');
                    string.className = 'string';
                    string.style.left = `${(stringIndex * stringSpacing) + stringOffset}%`;
                    string.style.height = `${(5 * fretSpacing) + nutHeight}px`; // Fixed height for 5 frets
                    fretboard.appendChild(string);
                    
                    const stringXPos = `${(stringIndex * stringSpacing) + stringOffset}%`;
                    const originalFret = frets[stringIndex];
                    
                    if (fretNum === 'x') {
                        const muted = document.createElement('span');
                        muted.className = 'muted-string';
                        muted.textContent = 'x';
                        muted.style.left = stringXPos;
                        muted.style.top = `-${topOffset}px`;
                        diagram.appendChild(muted);
                    } else if (fretNum === 0) {
                        // Check if this was originally an open string or became 0 due to capo transposition
                        if (originalFret === 0) {
                            // This was originally an open string
                            const open = document.createElement('span');
                            open.className = 'open-string';
                            open.innerHTML = '&#9675;';
                            open.style.left = stringXPos;
                            open.style.top = `-${topOffset}px`;
                            diagram.appendChild(open);
                        } else {
                            // This became 0 due to capo transposition, show as nut position with finger
                            const dot = document.createElement('div');
                            dot.className = 'dot';
                            dot.textContent = fingers[stringIndex];
                            dot.style.left = stringXPos;
                            // Position at the nut (just below it)
                            dot.style.top = `${nutHeight + (fretSpacing * 0.2)}px`;
                            fretboard.appendChild(dot);
                        }
                    } else {
                        const dot = document.createElement('div');
                        dot.className = 'dot';
                        dot.textContent = fingers[stringIndex];
                        dot.style.left = stringXPos;
                        dot.style.top = `${(fretNum * fretSpacing) - (fretSpacing/2) + nutHeight}px`;
                        fretboard.appendChild(dot);
                    }
                });
                
                // Update chord name to include capo if needed
                if (shouldUseCapo) {
                    chordNameEl.textContent = `${rootNote} ${chordType} (Capo ${capoPosition})`;
                }
                
                diagram.appendChild(fretboard);
                wrapper.appendChild(chordNameEl);
                wrapper.appendChild(diagram);
                
                return wrapper;
            }
            /**
             * Creates bar chord elements for fingers that span multiple strings
             */
            function createBarChords(fretboard, frets, fingers, isSmall = false, capoOffset = 0, isMini = false) {
                const stringSpacing = isMini ? 40 / 5 : 100 / 5;
                const stringOffset = isMini ? 25 : 0;
                const fingerGroups = {};
                const fretSpacing = isMini ? 14.4 : (isSmall ? 36 : 54);
                const nutHeight = isMini ? 3 : (isSmall ? 8 : 12);
                const barHeight = isMini ? 8 : (isSmall ? 18 : 24);
                
                // Group strings by finger number and fret position
                fingers.forEach((finger, stringIndex) => {
                    if (finger && finger !== null && finger !== undefined && 
                        frets[stringIndex] !== 'x' && frets[stringIndex] !== 0) {
                        const fretPos = frets[stringIndex];
                        const key = `${finger}-${fretPos}`;
                        if (!fingerGroups[key]) {
                            fingerGroups[key] = [];
                        }
                        fingerGroups[key].push(stringIndex);
                    }
                });
                // Create bars for fingers that span multiple strings at the same fret
                Object.entries(fingerGroups).forEach(([key, strings]) => {
                    if (strings.length >= 2) {
                        const [finger, fret] = key.split('-');
                        
                        // Sort strings from lowest to highest
                        strings.sort((a, b) => a - b);
                        const minString = strings[0];
                        const maxString = strings[strings.length - 1];
                        
                        // Adjust fret position for capo offset
                        const displayFret = Math.max(0, parseInt(fret) - capoOffset);
                        
                        // Don't create a bar for fret 0 (open strings) as that would be positioned incorrectly
                        if (displayFret === 0) return;
                        
                        // Create barre for any finger on 2+ strings, regardless of gaps
                        // This handles cases like F chord where finger 1 spans strings 0, 4, 5
                        const bar = document.createElement('div');
                        bar.className = 'bar';
                        
                        const leftPos = minString * stringSpacing;
                        const rightPos = maxString * stringSpacing;
                        const width = rightPos - leftPos;
                        
                        bar.style.left = `${leftPos + stringOffset}%`;
                        bar.style.width = `${width}%`;
                        bar.style.height = `${barHeight}px`;
                        bar.style.top = `${(displayFret * fretSpacing) - (fretSpacing/2) + nutHeight}px`;
                        bar.style.transform = 'translateY(-50%)';
                        bar.style.borderRadius = `${barHeight/2}px`;
                        bar.style.zIndex = '1';
                        
                        fretboard.appendChild(bar);
                    }
                });
            }
            
            // --- PRACTICE TIMER FUNCTIONS ---
            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
            
            function updateDisplay() {
                timerDisplay.textContent = formatTime(timeRemaining);
            }
            
            function updateStatus(status, text) {
                timerStatus.className = `timer-status ${status}`;
                timerStatus.textContent = text;
            }
            
            function startTimer() {
                if (timeRemaining <= 0) {
                    timeRemaining = (parseInt(minutesInput.value) || 0) * 60 + (parseInt(secondsInput.value) || 0);
                    if (timeRemaining <= 0) {
                        timeRemaining = 300; // Default to 5 minutes
                        minutesInput.value = 5;
                        secondsInput.value = 0;
                    }
                }
                
                isRunning = true;
                isPaused = false;
                updateStatus('running', '🎸 Practice in progress...');
                startPauseBtn.textContent = '⏸️ Pause';
                
                timerInterval = setInterval(() => {
                    timeRemaining--;
                    updateDisplay();
                    
                    if (timeRemaining <= 0) {
                        stopTimer();
                        updateStatus('finished', '🎉 Practice session complete! 🎉');
                        showCompletionNotification();
                    }
                }, 1000);
            }
            
            function pauseTimer() {
                clearInterval(timerInterval);
                isRunning = false;
                isPaused = true;
                updateStatus('paused', '⏸️ Practice paused');
                startPauseBtn.textContent = '▶️ Resume';
            }
            
            function stopTimer() {
                clearInterval(timerInterval);
                isRunning = false;
                isPaused = false;
            }
            
            function resetTimer() {
                stopTimer();
                timeRemaining = (parseInt(minutesInput.value) || 0) * 60 + (parseInt(secondsInput.value) || 0);
                if (timeRemaining <= 0) {
                    timeRemaining = 300;
                    minutesInput.value = 5;
                    secondsInput.value = 0;
                }
                updateDisplay();
                updateStatus('idle', '🎸 Ready to practice');
                startPauseBtn.textContent = '▶️ Start';
            }
            
            function showCompletionNotification() {
                // Simple visual feedback when timer completes
                timerDisplay.style.animation = 'pulse 0.5s ease-in-out 3';
                setTimeout(() => {
                    timerDisplay.style.animation = '';
                }, 1500);
            }
            
            function setPresetTime(minutes, seconds) {
                minutesInput.value = minutes;
                secondsInput.value = seconds;
                if (!isRunning) {
                    timeRemaining = minutes * 60 + seconds;
                    updateDisplay();
                }
                
                // Update active preset button
                presetButtons.forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
            }

            // --- METRONOME FUNCTIONS ---
            function initAudioContext() {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                return audioContext;
            }

            function playMetronomeClick(isAccent = false) {
                const ctx = initAudioContext();
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                // Different pitch for accent beat
                oscillator.frequency.value = isAccent ? 1000 : 600;
                oscillator.type = 'square';
                
                gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.1);
            }

            function updateBpmDisplay() {
                metronomeDisplay.textContent = currentBpm;
                bpmSlider.value = currentBpm;
                bpmInput.value = currentBpm;
            }

            function updateTimeSignature(signature) {
                currentTimeSignature = parseInt(signature);
                currentBeat = 0;
                
                // Update active button
                timeSigButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-signature="${signature}"]`).classList.add('active');
                
                // Regenerate beat indicators
                generateBeatIndicators();
            }

            function generateBeatIndicators() {
                beatIndicators.innerHTML = '';
                
                for (let i = 0; i < currentTimeSignature; i++) {
                    const indicator = document.createElement('div');
                    indicator.className = 'beat-indicator';
                    indicator.textContent = i + 1;
                    beatIndicators.appendChild(indicator);
                }
            }

            function updateBeatIndicators() {
                const indicators = beatIndicators.querySelectorAll('.beat-indicator');
                indicators.forEach((indicator, index) => {
                    indicator.classList.remove('active', 'accent');
                    
                    if (index === currentBeat) {
                        if (index === 0) {
                            indicator.classList.add('accent'); // First beat is accented
                        } else {
                            indicator.classList.add('active');
                        }
                    }
                });
            }

            function startMetronome() {
                if (isMetronomeRunning) return;
                
                isMetronomeRunning = true;
                metronomeStatus.textContent = `🎵 Playing at ${currentBpm} BPM`;
                metronomeStatus.className = 'metronome-status running';
                
                const intervalTime = 60000 / currentBpm; // ms per beat
                
                // Play first beat immediately
                playMetronomeClick(currentBeat === 0);
                updateBeatIndicators();
                currentBeat = (currentBeat + 1) % currentTimeSignature;
                
                metronomeInterval = setInterval(() => {
                    playMetronomeClick(currentBeat === 0);
                    updateBeatIndicators();
                    currentBeat = (currentBeat + 1) % currentTimeSignature;
                }, intervalTime);
            }

            function stopMetronome() {
                if (!isMetronomeRunning) return;
                
                clearInterval(metronomeInterval);
                isMetronomeRunning = false;
                currentBeat = 0;
                
                metronomeStatus.textContent = '🎯 Ready to start';
                metronomeStatus.className = 'metronome-status stopped';
                
                // Reset beat indicators
                const indicators = beatIndicators.querySelectorAll('.beat-indicator');
                indicators.forEach(indicator => {
                    indicator.classList.remove('active', 'accent');
                });
            }

            // --- STRUMMING PATTERNS FUNCTIONS ---
            function renderStrummingPatterns() {
                const filteredPatterns = currentFilter === 'all' 
                    ? strummingPatterns 
                    : strummingPatterns.filter(pattern => pattern.difficulty === currentFilter);

                strummingPatternsGrid.innerHTML = '';

                filteredPatterns.forEach((pattern, index) => {
                    const patternCard = document.createElement('div');
                    patternCard.className = 'pattern-card';
                    
                    // Format pattern with proper styling
                    const formattedPattern = pattern.pattern.split('').map(char => {
                        switch(char) {
                            case 'D': return '<span class="strum-down">D</span>';
                            case 'U': return '<span class="strum-up">U</span>';
                            case 'X': return '<span class="strum-mute">X</span>';
                            case '-': return '<span class="strum-rest">-</span>';
                            case ' ': return ' ';
                            default: return char;
                        }
                    }).join('');

                    // Generate beat numbers based on time signature
                    const beatCount = pattern.timeSignature === '3/4' ? 3 : 
                                     pattern.timeSignature === '6/8' ? 6 : 4;
                    const beatNumbers = Array.from({length: beatCount}, (_, i) => `<span>${i + 1}</span>`).join('');

                    patternCard.innerHTML = `
                        <div class="pattern-header">
                            <h3 class="pattern-name">${pattern.name}</h3>
                            <span class="pattern-difficulty ${pattern.difficulty}">${pattern.difficulty}</span>
                        </div>
                        <div class="beat-numbers">${beatNumbers}</div>
                        <div class="pattern-notation">${formattedPattern}</div>
                        <div class="pattern-info">
                            <p class="pattern-description">${pattern.description}</p>
                            <p class="pattern-time-signature">Time Signature: ${pattern.timeSignature}</p>
                            <p class="pattern-genre">Genre: ${pattern.genre}</p>
                        </div>
                        <div class="pattern-controls">
                            <button class="pattern-play-btn" data-pattern="${index}">
                                <span>▶</span> Demo
                            </button>
                        </div>
                    `;

                    strummingPatternsGrid.appendChild(patternCard);
                });

                // Add event listeners to demo buttons
                const demoButtons = strummingPatternsGrid.querySelectorAll('.pattern-play-btn');
                demoButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const patternIndex = parseInt(e.currentTarget.dataset.pattern);
                        playPatternDemo(filteredPatterns[patternIndex]);
                    });
                });
            }

            function playPatternDemo(pattern) {
                // Stop any currently playing demo
                if (activePatternAudio) {
                    clearInterval(activePatternAudio);
                }

                const ctx = initAudioContext();
                const patternArray = pattern.pattern.split(' ');
                const bpm = 120; // Default demo BPM
                const beatDuration = 60000 / bpm; // ms per beat
                
                let beatIndex = 0;
                
                // Play first beat immediately
                playStrumSound(patternArray[0], ctx);
                beatIndex++;

                activePatternAudio = setInterval(() => {
                    if (beatIndex >= patternArray.length) {
                        clearInterval(activePatternAudio);
                        activePatternAudio = null;
                        return;
                    }
                    
                    playStrumSound(patternArray[beatIndex], ctx);
                    beatIndex++;
                }, beatDuration);
            }

            function playStrumSound(strumType, ctx) {
                if (strumType === '-') return; // Rest - no sound
                
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                // Different sounds for different strum types
                switch(strumType) {
                    case 'D': // Down strum - lower pitch
                        oscillator.frequency.value = 200;
                        oscillator.type = 'sawtooth';
                        gainNode.gain.setValueAtTime(0.2, ctx.currentTime);
                        break;
                    case 'U': // Up strum - higher pitch
                        oscillator.frequency.value = 400;
                        oscillator.type = 'sawtooth';
                        gainNode.gain.setValueAtTime(0.15, ctx.currentTime);
                        break;
                    case 'X': // Muted strum - percussive
                        oscillator.frequency.value = 100;
                        oscillator.type = 'square';
                        gainNode.gain.setValueAtTime(0.1, ctx.currentTime);
                        break;
                    default:
                        return;
                }
                
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.2);
            }

            function filterPatterns(filter) {
                currentFilter = filter;
                
                // Update active filter button
                filterButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
                
                // Re-render patterns
                renderStrummingPatterns();
            }
            
            // --- PAGE 1: CHORD LIBRARY ---
            function initLibraryPage() {
                populateSelectors();
                rootNoteSelector.addEventListener('change', (e) => {
                    updateChordTypes(e.target.value);
                    drawLibraryChord();
                });
                chordTypeSelector.addEventListener('change', drawLibraryChord);
                drawLibraryChord();
            }
            
            function populateSelectors() {
                const rootNotes = Object.keys(chordData);
                rootNotes.forEach(note => {
                    const option = document.createElement('option');
                    option.value = note;
                    option.textContent = note;
                    rootNoteSelector.appendChild(option);
                });
                updateChordTypes(rootNotes[0]);
            }
            function updateChordTypes(note) {
                const currentType = chordTypeSelector.value;
                chordTypeSelector.innerHTML = '';
                const chordTypes = Object.keys(chordData[note] || {});
                chordTypes.forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    chordTypeSelector.appendChild(option);
                });
                if (chordTypes.includes(currentType)) {
                    chordTypeSelector.value = currentType;
                }
            }
            function drawLibraryChord() {
                const rootNote = rootNoteSelector.value;
                const chordType = chordTypeSelector.value;
                const chord = chordData[rootNote]?.[chordType];
                chordDisplay.innerHTML = '';
                if (!chord) {
                    chordDisplay.innerHTML = `<div id="no-chord-message">🎵 Chord data not available 🎵</div>`;
                    return;
                }
                const diagram = createChordDiagram(rootNote, chordType, chord);
                // Make the name larger for the main display
                diagram.querySelector('.chord-guide-name').id = 'chord-name';
                diagram.querySelector('#chord-name').className = '';
                
                chordDisplay.appendChild(diagram);
            }
            // --- PAGE 2: SONGS PAGE ---
            function initSongsPage() {
                // Populate song cards with chord diagrams below each song
                songData.forEach(song => {
                    const card = document.createElement('div');
                    card.className = 'song-card';
                    card.innerHTML = `
                        <h3>🎵 ${song.title}</h3>
                        <p class="artist">🎤 ${song.artist}</p>
                        <p class="chords">${song.chords.join(' - ')}</p>
                    `;
                    
                    // Create collapsible chord section
                    const chordSection = document.createElement('div');
                    chordSection.className = 'chord-toggle-section';
                    
                    const toggleBtn = document.createElement('button');
                    toggleBtn.className = 'chord-toggle-btn';
                    toggleBtn.innerHTML = `
                        🎸 Show Chord Diagrams
                        <span class="arrow">▼</span>
                    `;
                    
                    const chordDisplay = document.createElement('div');
                    chordDisplay.className = 'song-chord-display';
                    
                    // Display all chords vertically in a single column
                    song.chords.forEach(chordName => {
                        let rootNote, chordType;
                        if (chordName.endsWith('m')) {
                            rootNote = chordName.slice(0, -1); // Remove 'm' suffix
                            chordType = 'Minor';
                        } else {
                            rootNote = chordName;
                            chordType = 'Major';
                        }
                        const chord = chordData[rootNote]?.[chordType];
                        if (chord) {
                            const diagram = createChordDiagram(rootNote, chordType, chord, true);
                            chordDisplay.appendChild(diagram);
                        }
                    });
                    
                    // Toggle functionality
                    toggleBtn.addEventListener('click', () => {
                        const isExpanded = chordDisplay.classList.contains('expanded');
                        if (isExpanded) {
                            chordDisplay.classList.remove('expanded');
                            toggleBtn.classList.remove('expanded');
                            toggleBtn.innerHTML = `
                                🎸 Show Chord Diagrams
                                <span class="arrow">▼</span>
                            `;
                        } else {
                            chordDisplay.classList.add('expanded');
                            toggleBtn.classList.add('expanded');
                            toggleBtn.innerHTML = `
                                🙈 Hide Chord Diagrams
                                <span class="arrow">▼</span>
                            `;
                        }
                    });
                    
                    chordSection.appendChild(toggleBtn);
                    chordSection.appendChild(chordDisplay);
                    card.appendChild(chordSection);
                    songListContainer.appendChild(card);
                });
            }
            // --- PAGE 3: PROGRESS PAGE ---
            function initProgressPage() {
                updateProgressStats();
                updateProgressBar();
                renderChordProgressGrid();
            }
            function updateProgressStats() {
                const totalChords = getTotalChordCount();
                const learnedCount = learnedChords.size;
                const progressPercentage = totalChords > 0 ? Math.round((learnedCount / totalChords) * 100) : 0;
                progressStatsContainer.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${learnedCount}</div>
                        <div class="stat-label">✅ Learned</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${totalChords}</div>
                        <div class="stat-label">🎸 Total Chords</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${progressPercentage}%</div>
                        <div class="stat-label">📈 Progress</div>
                    </div>
                `;
            }
            function updateProgressBar() {
                const totalChords = getTotalChordCount();
                const learnedCount = learnedChords.size;
                const progressPercentage = totalChords > 0 ? Math.round((learnedCount / totalChords) * 100) : 0;
                // Update progress bar width with animation
                progressBarFill.style.width = `${progressPercentage}%`;
                
                // Update progress text
                progressBarText.textContent = `${learnedCount} of ${totalChords} chords learned`;
                // Update milestone achievements
                const milestones = [
                    { id: 'milestone-25', threshold: 25 },
                    { id: 'milestone-50', threshold: 50 },
                    { id: 'milestone-75', threshold: 75 },
                    { id: 'milestone-100', threshold: 100 }
                ];
                milestones.forEach(milestone => {
                    const element = document.getElementById(milestone.id);
                    if (progressPercentage >= milestone.threshold) {
                        element.classList.add('achieved');
                    } else {
                        element.classList.remove('achieved');
                    }
                });
            }
            function getTotalChordCount() {
                let count = 0;
                Object.keys(chordData).forEach(rootNote => {
                    count += Object.keys(chordData[rootNote]).length;
                });
                return count;
            }
            function toggleChordLearned(chordKey, checkbox, item) {
                if (learnedChords.has(chordKey)) {
                    // Mark as not learned
                    learnedChords.delete(chordKey);
                    checkbox.classList.remove('checked');
                    checkbox.innerHTML = '';
                    item.classList.remove('learned');
                } else {
                    // Mark as learned
                    learnedChords.add(chordKey);
                    checkbox.classList.add('checked');
                    checkbox.innerHTML = '✓';
                    item.classList.add('learned');
                }
                updateProgressStats();
                updateProgressBar();
            }
            function renderChordProgressGrid() {
                chordProgressGrid.innerHTML = '';
                
                // Group chords by difficulty
                const chordsByDifficulty = {
                    'Beginner': [],
                    'Intermediate': [],
                    'Advanced': []
                };
                
                Object.keys(chordData).forEach(rootNote => {
                    Object.keys(chordData[rootNote]).forEach(chordType => {
                        const chordKey = `${rootNote}-${chordType}`;
                        const chord = chordData[rootNote][chordType];
                        const difficulty = getChordDifficulty(chordType);
                        
                        chordsByDifficulty[difficulty].push({
                            rootNote,
                            chordType,
                            chord,
                            chordKey
                        });
                    });
                });
                
                // Render each difficulty section
                Object.keys(chordsByDifficulty).forEach(difficulty => {
                    if (chordsByDifficulty[difficulty].length > 0) {
                        // Create section header
                        const header = document.createElement('div');
                        header.className = 'difficulty-header';
                        const difficultyEmoji = difficulty === 'Beginner' ? '🌱' : 
                                               difficulty === 'Intermediate' ? '🎸' : '⭐';
                        header.innerHTML = `
                            <h3>${difficultyEmoji} ${difficulty} Chords</h3>
                            <p>${chordsByDifficulty[difficulty].length} chords to master</p>
                        `;
                        chordProgressGrid.appendChild(header);
                        
                        // Create section grid
                        const sectionGrid = document.createElement('div');
                        sectionGrid.className = 'difficulty-section';
                        
                        chordsByDifficulty[difficulty].forEach(({ rootNote, chordType, chord, chordKey }) => {
                            const item = document.createElement('div');
                            item.className = 'chord-progress-item';
                            
                            const checkbox = document.createElement('div');
                            checkbox.className = 'chord-checkbox';
                            
                            // Check if this chord is already learned
                            if (learnedChords.has(chordKey)) {
                                checkbox.classList.add('checked');
                                checkbox.innerHTML = '✓';
                                item.classList.add('learned');
                            }
                            
                            // Add click handler to toggle learned state
                            checkbox.addEventListener('click', () => {
                                toggleChordLearned(chordKey, checkbox, item);
                            });
                            
                            const chordInfo = document.createElement('div');
                            chordInfo.className = 'chord-info';
                            chordInfo.innerHTML = `
                                <h4>🎵 ${rootNote} ${chordType}</h4>
                                <p>${difficultyEmoji} ${difficulty}</p>
                            `;
                            
                            const miniDiagram = createChordDiagram(rootNote, chordType, chord, false, true);
                            
                            item.appendChild(checkbox);
                            item.appendChild(chordInfo);
                            item.appendChild(miniDiagram);
                            sectionGrid.appendChild(item);
                        });
                        
                        chordProgressGrid.appendChild(sectionGrid);
                    }
                });
            }
            function getChordDifficulty(chordType) {
                const difficulties = {
                    'Major': 'Beginner',
                    'Minor': 'Beginner',
                    '7th': 'Intermediate',
                    'sus4': 'Intermediate',
                    'aug': 'Advanced',
                    'dim': 'Advanced'
                };
                return difficulties[chordType] || 'Intermediate';
            }
            
            // --- PAGE 4: PRACTICE TIMER ---
            function initPracticeTimer() {
                // Initialize timer display
                updateDisplay();
                
                // Event listeners for timer controls
                startPauseBtn.addEventListener('click', () => {
                    if (!isRunning && !isPaused) {
                        startTimer();
                    } else if (isRunning) {
                        pauseTimer();
                    } else if (isPaused) {
                        startTimer();
                    }
                });
                
                resetBtn.addEventListener('click', resetTimer);
                
                // Event listeners for time inputs
                minutesInput.addEventListener('change', () => {
                    if (!isRunning) {
                        resetTimer();
                    }
                });
                
                secondsInput.addEventListener('change', () => {
                    if (!isRunning) {
                        resetTimer();
                    }
                });
                
                // Event listeners for preset buttons
                presetButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const minutes = parseInt(e.target.dataset.minutes);
                        const seconds = parseInt(e.target.dataset.seconds);
                        setPresetTime(minutes, seconds);
                    });
                });
                
                // Add CSS animation for pulse effect
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes pulse {
                        0% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                        100% { transform: scale(1); }
                    }
                `;
                document.head.appendChild(style);
            }

            // --- PAGE 6: METRONOME ---
            function initMetronome() {
                // Initialize display and beat indicators
                updateBpmDisplay();
                generateBeatIndicators();
                
                // BPM Slider
                bpmSlider.addEventListener('input', (e) => {
                    currentBpm = parseInt(e.target.value);
                    updateBpmDisplay();
                    
                    // Restart metronome if running to apply new tempo
                    if (isMetronomeRunning) {
                        stopMetronome();
                        startMetronome();
                    }
                });
                
                // BPM Input
                bpmInput.addEventListener('change', (e) => {
                    let value = parseInt(e.target.value);
                    if (value < 30) value = 30;
                    if (value > 200) value = 200;
                    
                    currentBpm = value;
                    updateBpmDisplay();
                    
                    // Restart metronome if running to apply new tempo
                    if (isMetronomeRunning) {
                        stopMetronome();
                        startMetronome();
                    }
                });
                
                // Time Signature Buttons
                timeSigButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        updateTimeSignature(e.target.dataset.signature);
                        
                        // Restart metronome if running to apply new time signature
                        if (isMetronomeRunning) {
                            stopMetronome();
                            startMetronome();
                        }
                    });
                });
                
                // Control Buttons
                metronomeStartBtn.addEventListener('click', () => {
                    if (!isMetronomeRunning) {
                        // Initialize audio context on user interaction
                        initAudioContext();
                        startMetronome();
                    }
                });
                
                metronomeStopBtn.addEventListener('click', () => {
                    if (isMetronomeRunning) {
                        stopMetronome();
                    }
                });
            }

            // --- PAGE 7: STRUMMING PATTERNS ---
            function initStrummingPatterns() {
                // Render initial patterns
                renderStrummingPatterns();
                
                // Add filter event listeners
                filterButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const filter = e.target.dataset.filter;
                        filterPatterns(filter);
                    });
                });
            }
            
            // --- NAVIGATION ---
            function handleNavClick(e) {
                e.preventDefault();
                const targetPageId = e.currentTarget.dataset.page;
                // Update nav link styles
                navLinks.forEach(link => link.classList.remove('active'));
                e.currentTarget.classList.add('active');
                // Switch visible page
                pages.forEach(page => {
                    if (page.id === targetPageId) {
                        page.classList.add('active');
                    } else {
                        page.classList.remove('active');
                    }
                });
                // Update progress page when switching to it
                if (targetPageId === 'progress-page') {
                    updateProgressStats();
                    updateProgressBar();
                    renderChordProgressGrid();
                }
            }
            navLinks.forEach(link => link.addEventListener('click', handleNavClick));
            // --- RESET PROGRESS FUNCTIONALITY ---
            const resetProgressBtn = document.getElementById('reset-progress-btn');
            
            function showConfirmDialog(message, onConfirm) {
                const modal = document.createElement('div');
                modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 50;';
                
                const dialogBox = document.createElement('div');
                dialogBox.style.cssText = 'background: var(--card-gradient); padding: 2rem; border-radius: 20px; box-shadow: 0 12px 48px var(--shadow-color); max-width: 400px; width: 90%; margin: 0 1rem; border: 2px solid var(--border-color);';
                
                const messageEl = document.createElement('p');
                messageEl.style.cssText = 'color: var(--text-color); margin-bottom: 1.5rem; font-size: 1.1rem; text-align: center; font-weight: 500;';
                messageEl.textContent = message;
                
                const buttonContainer = document.createElement('div');
                buttonContainer.style.cssText = 'display: flex; justify-content: center; gap: 1rem;';
                
                const cancelBtn = document.createElement('button');
                cancelBtn.style.cssText = 'padding: 0.75rem 1.5rem; background: var(--secondary-color); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease;';
                cancelBtn.textContent = '❌ Cancel';
                cancelBtn.addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                const confirmBtn = document.createElement('button');
                confirmBtn.style.cssText = 'padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease;';
                confirmBtn.textContent = '🔄 Reset';
                confirmBtn.addEventListener('click', () => {
                    document.body.removeChild(modal);
                    onConfirm();
                });
                
                buttonContainer.appendChild(cancelBtn);
                buttonContainer.appendChild(confirmBtn);
                dialogBox.appendChild(messageEl);
                dialogBox.appendChild(buttonContainer);
                modal.appendChild(dialogBox);
                document.body.appendChild(modal);
            }
            resetProgressBtn.addEventListener('click', () => {
                showConfirmDialog(
                    '🤔 Are you sure you want to reset all progress? This will uncheck all learned chords.',
                    function() {
                        learnedChords.clear();
                        updateProgressStats();
                        updateProgressBar();
                        renderChordProgressGrid();
                    }
                );
            });
            // --- REFRESH FUNCTIONS FOR DYNAMIC UPDATES ---
            window.refreshAllPages = function() {
                // Re-populate library page selectors
                const currentRoot = rootNoteSelector.value;
                const currentType = chordTypeSelector.value;
                
                rootNoteSelector.innerHTML = '';
                populateSelectors();
                
                // Try to maintain current selection
                if (currentRoot && Object.keys(chordData).includes(currentRoot)) {
                    rootNoteSelector.value = currentRoot;
                    updateChordTypes(currentRoot);
                    if (currentType && Object.keys(chordData[currentRoot] || {}).includes(currentType)) {
                        chordTypeSelector.value = currentType;
                    }
                }
                drawLibraryChord();
                
                // Re-render progress page
                updateProgressStats();
                updateProgressBar();
                renderChordProgressGrid();
                
                console.log('All pages refreshed with new chord data!');
            };
            // --- PAGE 5: GUITAR TIPS ---
            function initGuitarTips() {
                const allGuitarTips = document.getElementById('all-guitar-tips');
                
                const guitarTips = [
                    { title: "🎯 Start with Basic Chords", text: "Begin with fundamental chords like G, C, D, Em, and Am. These five chords can play hundreds of songs and build finger strength." },
                    { title: "⏰ Practice Daily", text: "Even 15 minutes of daily practice is better than 2 hours once a week. Consistency builds muscle memory and finger dexterity." },
                    { title: "🐌 Start Slow", text: "Always practice slowly first. Speed comes naturally with accuracy. Use a metronome to maintain steady tempo." },
                    { title: "🤲 Proper Hand Position", text: "Keep your fretting hand thumb behind the neck, curve your fingers, and avoid touching other strings." },
                    { title: "📝 Use a Practice Journal", text: "Track what you practice, your progress, and problem areas. This helps you focus on weak points." },
                    { title: "🎵 Learn Songs You Love", text: "Choose songs you enjoy listening to. You'll be more motivated to practice and overcome challenges." },
                    { title: "🔄 Practice Chord Changes", text: "Spend time transitioning between two chords slowly, then gradually increase speed. This builds muscle memory." },
                    { title: "👂 Train Your Ear", text: "Try to play songs by ear. Start with simple melodies and gradually work up to chord progressions." },
                    { title: "🎯 Focus on Clean Notes", text: "Better to play slowly and cleanly than fast and sloppy. Each note should ring clearly without buzzing." },
                    { title: "🔧 Keep Your Guitar in Tune", text: "Always tune your guitar before practicing. Playing on an out-of-tune guitar trains your ear incorrectly." },
                    { title: "💡 Use a Metronome", text: "Develop timing by practicing with a metronome. Start slow and gradually increase the tempo." },
                    { title: "🎬 Record Yourself", text: "Record your playing to hear mistakes you might miss while concentrating on finger positions." },
                    { title: "📐 Proper Posture", text: "Sit up straight, keep the guitar body vertical, and avoid hunching over. Good posture prevents back pain." },
                    { title: "🛠️ Regular Maintenance", text: "Keep strings clean, change them regularly, and adjust action if needed. A well-maintained guitar is easier to play." },
                    { title: "👥 Play with Others", text: "Join jam sessions or play with friends. Playing with others improves timing and teaches you to listen." },
                    { title: "📚 Learn Music Theory", text: "Understanding basic theory (scales, chord construction) helps you understand why things work together." },
                    { title: "🎪 Practice Different Genres", text: "Explore various musical styles. Each genre teaches different techniques and expands your musical vocabulary." },
                    { title: "🎸 Alternate Picking", text: "Use alternating up and down pick strokes for efficiency and speed. Start slowly and focus on accuracy." },
                    { title: "🎼 Read Tablature", text: "Learn to read guitar tabs. They're easier than standard notation and help you learn songs faster." },
                    { title: "🔄 Finger Exercises", text: "Practice finger independence exercises like chromatic runs (1-2-3-4 on each string) to build dexterity." },
                    { title: "🎯 Master Barre Chords", text: "Start with easier barre chords (like F major) and gradually work up. They unlock many more songs." },
                    { title: "🎵 Learn Scales", text: "Start with pentatonic and major scales. They're the foundation for solos and understanding music structure." },
                    { title: "⚡ Build Finger Strength", text: "Use finger strengthening exercises, but don't overdo it. Gradual building prevents injury." },
                    { title: "🎯 Practice Problem Areas", text: "Identify your weak spots and spend extra time on them. Don't just play what you already know well." },
                    { title: "🎸 Learn Basic Strumming", text: "Master down-up strumming patterns. Start with simple patterns and gradually add complexity." },
                    { title: "📱 Use Learning Apps", text: "Supplement practice with guitar learning apps for chord recognition, tuning, and song tutorials." },
                    { title: "🎭 Play Different Dynamics", text: "Practice playing both softly and loudly. Dynamic control adds expression to your playing." },
                    { title: "🔧 Understand Your Guitar", text: "Learn about your instrument - where the controls are, how to adjust them, and basic maintenance." },
                    { title: "🎵 Memorize Chord Shapes", text: "Visualize chord shapes away from the guitar. Mental practice reinforces physical muscle memory." },
                    { title: "⏱️ Set Practice Goals", text: "Have specific goals for each practice session. 'I'll master the G-to-C transition' is better than just 'practice.'" },
                    { title: "🎸 Try Different Pick Thicknesses", text: "Experiment with different pick gauges. Thinner picks are easier for strumming, thicker for precision." },
                    { title: "🔄 Practice Unplugged", text: "For electric guitars, practice unplugged sometimes to focus on technique without effects masking mistakes." },
                    { title: "📏 Learn Proper Fretting", text: "Press strings just behind frets, not on top of them. Use just enough pressure to avoid buzzing." },
                    { title: "🎯 Start with Open Chords", text: "Master open chords before moving to barre chords. They're the foundation of guitar playing." },
                    { title: "🎵 Learn to Read Rhythm", text: "Understand basic rhythm notation. Being able to read rhythms helps you learn songs more accurately." },
                    { title: "🔄 Practice Hammer-ons and Pull-offs", text: "These techniques add fluidity to your playing and are essential for many guitar styles." },
                    { title: "⚡ Don't Rush Solos", text: "Learn solos phrase by phrase, not note by note. Understanding the musical phrases makes them easier to remember." },
                    { title: "🎸 Experiment with Capos", text: "A capo opens up new chord voicings and keys while using familiar chord shapes." },
                    { title: "🎯 Practice Standing Up", text: "If you plan to perform, practice playing while standing. It feels different than sitting down." },
                    { title: "📱 Use YouTube Tutorials", text: "There are countless free tutorials online. Find instructors whose teaching style works for you." },
                    { title: "🎵 Learn Songs in Different Keys", text: "Transpose songs to different keys to practice various chord combinations and improve your understanding." },
                    { title: "🔄 Warm Up Properly", text: "Start practice sessions with simple exercises to warm up your fingers and prevent injury." },
                    { title: "🎸 Listen Actively", text: "When listening to music, focus on the guitar parts. Try to identify chords, techniques, and patterns." },
                    { title: "⏰ Take Breaks", text: "Rest your hands every 20-30 minutes during long practice sessions to prevent fatigue and injury." },
                    { title: "🎯 Learn Both Rhythm and Lead", text: "Don't focus only on solos or only on chords. Both rhythm and lead guitar are equally important." },
                    { title: "🔧 Adjust Your Setup", text: "Lower action (string height) makes the guitar easier to play, but too low causes buzzing. Find your sweet spot." },
                    { title: "🎵 Play Along with Records", text: "Playing along with original recordings helps develop timing and teaches you how songs really sound." },
                    { title: "📚 Learn from Multiple Sources", text: "Don't rely on just one teacher or method. Different perspectives help you understand concepts better." },
                    { title: "🎪 Challenge Yourself", text: "Regularly attempt songs slightly above your current skill level. This pushes your boundaries and accelerates learning." },
                    { title: "🔄 Review Old Material", text: "Periodically revisit songs and techniques you learned earlier to maintain and refine your skills." },
                    { title: "🎯 Focus on Weak Hand", text: "Your fretting hand typically needs more attention than your picking hand. Spend extra time on finger exercises." }
                ];
                
                guitarTips.forEach(tip => {
                    const tipCard = document.createElement('div');
                    tipCard.className = 'tip-card';
                    tipCard.innerHTML = `
                        <h3>${tip.title}</h3>
                        <p>${tip.text}</p>
                    `;
                    allGuitarTips.appendChild(tipCard);
                });
            }
            
            // --- TAB TUTORIAL FUNCTIONS ---
            function initTabTutorial() {
                console.log('Initializing Tab Tutorial...');
                
                // Single consolidated event listener for all tab tutorial interactions
                document.addEventListener('click', (e) => {
                    // Tab navigation
                    if (e.target.classList.contains('tab-nav-btn')) {
                        const targetSection = e.target.dataset.section;
                        switchTabSection(targetSection);
                        return;
                    }
                    
                    // Lesson navigation
                    if (e.target.id === 'prev-lesson') {
                        if (currentLesson > 1) {
                            currentLesson--;
                            updateLessonDisplay();
                        }
                        return;
                    } else if (e.target.id === 'next-lesson') {
                        if (currentLesson < totalLessons) {
                            currentLesson++;
                            updateLessonDisplay();
                        }
                        return;
                    }
                    
                    // Exercise 1 answers
                    if (e.target.hasAttribute('data-answer') && e.target.classList.contains('exercise-btn')) {
                        e.preventDefault();
                        checkExercise1Answer(e.target.dataset.answer);
                        return;
                    }
                    
                    // Exercise 2 chord answers
                    if (e.target.hasAttribute('data-chord') && e.target.classList.contains('exercise-btn')) {
                        e.preventDefault();
                        checkExercise2Answer(e.target.dataset.chord);
                        return;
                    }
                    
                    // Exercise 3 symbol answers
                    if (e.target.hasAttribute('data-symbol') && e.target.classList.contains('exercise-btn')) {
                        e.preventDefault();
                        checkExercise3Answer(e.target.dataset.symbol);
                        return;
                    }
                    
                    // New exercise buttons
                    if (e.target.id === 'new-exercise-1') {
                        e.preventDefault();
                        generateNewExercise1();
                        return;
                    } else if (e.target.id === 'new-exercise-2') {
                        e.preventDefault();
                        generateNewExercise2();
                        return;
                    } else if (e.target.id === 'new-exercise-3') {
                        e.preventDefault();
                        generateNewExercise3();
                        return;
                    }
                    
                    // Tab note clicks for audio feedback
                    if (e.target.classList.contains('tab-note')) {
                        e.target.classList.add('highlighted');
                        setTimeout(() => {
                            e.target.classList.remove('highlighted');
                        }, 600);
                        playTabNoteSound();
                        return;
                    }
                });
                
                // Initialize tutorial display and first exercises
                updateLessonDisplay();
                
                // Initialize exercises with default content
                setTimeout(() => {
                    generateNewExercise1();
                    generateNewExercise2(); 
                    generateNewExercise3();
                }, 100);
                
                console.log('Tab Tutorial initialized successfully');
            }

            function switchTabSection(sectionName) {
                console.log('Switching to section:', sectionName);
                currentTabSection = sectionName;
                
                // Update navigation buttons
                const tabNavButtons = document.querySelectorAll('.tab-nav-btn');
                tabNavButtons.forEach(btn => {
                    if (btn.dataset.section === sectionName) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
                
                // Update sections
                const tabSections = document.querySelectorAll('.tab-section');
                tabSections.forEach(section => {
                    if (section.id === `${sectionName}-section`) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
            }

            function updateLessonDisplay() {
                console.log('Updating lesson display to lesson:', currentLesson);
                
                // Update lesson content
                const lessonContents = document.querySelectorAll('.lesson-content');
                lessonContents.forEach((content, index) => {
                    if (index + 1 === currentLesson) {
                        content.classList.add('active');
                    } else {
                        content.classList.remove('active');
                    }
                });
                
                // Update progress dots
                const progressDots = document.querySelectorAll('.progress-dot');
                progressDots.forEach((dot, index) => {
                    dot.classList.remove('active', 'completed');
                    if (index + 1 === currentLesson) {
                        dot.classList.add('active');
                    } else if (index + 1 < currentLesson) {
                        dot.classList.add('completed');
                    }
                });
                
                // Update lesson counter
                const currentLessonEl = document.getElementById('current-lesson');
                const totalLessonsEl = document.getElementById('total-lessons');
                if (currentLessonEl) currentLessonEl.textContent = currentLesson;
                if (totalLessonsEl) totalLessonsEl.textContent = totalLessons;
                
                // Update navigation buttons
                const prevBtn = document.getElementById('prev-lesson');
                const nextBtn = document.getElementById('next-lesson');
                
                if (prevBtn) prevBtn.disabled = currentLesson === 1;
                if (nextBtn) nextBtn.disabled = currentLesson === totalLessons;
            }

            function checkExercise1Answer(answer) {
                console.log('Checking exercise 1 answer:', answer);
                const feedback = document.getElementById('exercise-1-feedback');
                const correctAnswer = exerciseAnswers.exercise1.correct;
                
                if (!feedback) {
                    console.error('Exercise 1 feedback element not found');
                    return;
                }
                
                if (answer === correctAnswer) {
                    feedback.textContent = '🎉 Correct! That note is on the ' + correctAnswer + ' fret.';
                    feedback.className = 'feedback-display success';
                    
                    // Generate new exercise after 2 seconds
                    setTimeout(() => {
                        generateNewExercise1();
                    }, 2000);
                } else {
                    feedback.textContent = '❌ Not quite right. Try again! Look at which fret the note is positioned on.';
                    feedback.className = 'feedback-display error';
                }
            }

            function generateNewExercise1() {
                console.log('Generating new exercise 1');
                const randomExercise = exerciseData.exercise1[Math.floor(Math.random() * exerciseData.exercise1.length)];
                exerciseAnswers.exercise1.correct = randomExercise.answer;
                
                // Update the tab note position and text
                const tabNote = document.querySelector('#exercise-1-staff .tab-note');
                if (tabNote) {
                    tabNote.style.top = randomExercise.string + 'px';
                    tabNote.textContent = randomExercise.fret; // Show the actual fret number
                    tabNote.dataset.answer = randomExercise.answer;
                    tabNote.classList.add('highlighted'); // Make it stand out
                }
                
                // Generate 4 random options (1 correct, 3 incorrect)
                const options = generateRandomOptions(randomExercise.answer, 'fret');
                updateExerciseButtons('exercise-1', options, randomExercise.answer);
                
                // Reset feedback
                const feedback = document.getElementById('exercise-1-feedback');
                if (feedback) {
                    feedback.textContent = `Click the correct fret number for the highlighted note. ${randomExercise.description}`;
                    feedback.className = 'feedback-display';
                }
            }

            function checkExercise2Answer(answer) {
                console.log('Checking exercise 2 answer:', answer);
                const feedback = document.getElementById('exercise-2-feedback');
                const correctAnswer = exerciseAnswers.exercise2.correct;
                
                if (!feedback) {
                    console.error('Exercise 2 feedback element not found');
                    return;
                }
                
                if (answer === correctAnswer) {
                    feedback.textContent = '🎉 Excellent! That is indeed ' + correctAnswer + ' chord.';
                    feedback.className = 'feedback-display success';
                    
                    // Generate new exercise after 2 seconds
                    setTimeout(() => {
                        generateNewExercise2();
                    }, 2000);
                } else {
                    feedback.textContent = '❌ Not quite. Look at the fret pattern more carefully.';
                    feedback.className = 'feedback-display error';
                }
            }

            function generateNewExercise2() {
                console.log('Generating new exercise 2');
                const randomExercise = exerciseData.exercise2[Math.floor(Math.random() * exerciseData.exercise2.length)];
                exerciseAnswers.exercise2.correct = randomExercise.answer;
                
                // Update the tab chord display
                const tabNotes = document.querySelectorAll('#exercise-2-staff .tab-note');
                if (tabNotes.length > 0) {
                    randomExercise.frets.forEach((fret, index) => {
                        if (tabNotes[index]) {
                            tabNotes[index].textContent = fret;
                            tabNotes[index].classList.add('highlighted');
                        }
                    });
                }
                
                // Generate 4 random options (1 correct, 3 incorrect)
                const options = generateRandomOptions(randomExercise.answer, 'chord');
                updateExerciseButtons('exercise-2', options, randomExercise.answer);
                
                // Reset feedback
                const feedback = document.getElementById('exercise-2-feedback');
                if (feedback) {
                    feedback.textContent = 'What chord is shown in the tablature above?';
                    feedback.className = 'feedback-display';
                }
            }

            function checkExercise3Answer(answer) {
                console.log('Checking exercise 3 answer:', answer);
                const feedback = document.getElementById('exercise-3-feedback');
                const correctAnswer = exerciseAnswers.exercise3.correct;
                
                if (!feedback) {
                    console.error('Exercise 3 feedback element not found');
                    return;
                }
                
                if (answer === correctAnswer) {
                    feedback.textContent = '🎉 Perfect! You correctly identified the ' + correctAnswer + ' symbol.';
                    feedback.className = 'feedback-display success';
                    
                    // Generate new exercise after 2 seconds
                    setTimeout(() => {
                        generateNewExercise3();
                    }, 2000);
                } else {
                    feedback.textContent = '❌ Not correct. Look at the symbol more carefully.';
                    feedback.className = 'feedback-display error';
                }
            }

            function generateNewExercise3() {
                console.log('Generating new exercise 3');
                const randomExercise = exerciseData.exercise3[Math.floor(Math.random() * exerciseData.exercise3.length)];
                exerciseAnswers.exercise3.correct = randomExercise.answer;
                
                // Update the symbol display
                const symbolDisplay = document.querySelector('#exercise-3-staff span');
                if (symbolDisplay) {
                    symbolDisplay.textContent = randomExercise.symbol;
                    symbolDisplay.style.color = 'var(--primary-color)';
                    symbolDisplay.style.fontWeight = 'bold';
                }
                
                // Generate 4 random options (1 correct, 3 incorrect)
                const options = generateRandomOptions(randomExercise.answer, 'symbol');
                updateExerciseButtons('exercise-3', options, randomExercise.answer);
                
                // Reset feedback
                const feedback = document.getElementById('exercise-3-feedback');
                if (feedback) {
                    feedback.textContent = 'What does this symbol represent in tablature?';
                    feedback.className = 'feedback-display';
                }
            }

            // --- EXERCISE HELPER FUNCTIONS ---
            function generateRandomOptions(correctAnswer, type) {
                const allOptions = [];
                
                if (type === 'fret') {
                    // Generate fret numbers from 0-12
                    for (let i = 0; i <= 12; i++) {
                        allOptions.push(i.toString());
                    }
                } else if (type === 'chord') {
                    // Get all unique chord names from exercise data
                    exerciseData.exercise2.forEach(ex => {
                        if (!allOptions.includes(ex.answer)) {
                            allOptions.push(ex.answer);
                        }
                    });
                } else if (type === 'symbol') {
                    // Get all unique technique names from exercise data
                    exerciseData.exercise3.forEach(ex => {
                        if (!allOptions.includes(ex.answer)) {
                            allOptions.push(ex.answer);
                        }
                    });
                }
                
                // Remove correct answer from pool
                const incorrectOptions = allOptions.filter(option => option !== correctAnswer);
                
                // Shuffle and pick 3 random incorrect options
                const shuffled = incorrectOptions.sort(() => Math.random() - 0.5);
                const selectedIncorrect = shuffled.slice(0, 3);
                
                // Add correct answer and shuffle all 4 options
                const finalOptions = [correctAnswer, ...selectedIncorrect];
                return finalOptions.sort(() => Math.random() - 0.5);
            }

            function updateExerciseButtons(exerciseId, options, correctAnswer) {
                // Map exercise IDs to container selectors
                const containerSelectors = {
                    'exercise-1': '.exercise-container:nth-child(1) .exercise-controls',
                    'exercise-2': '.exercise-container:nth-child(2) .exercise-controls', 
                    'exercise-3': '.exercise-container:nth-child(3) .exercise-controls'
                };
                
                const controlsContainer = document.querySelector(containerSelectors[exerciseId]);
                
                if (!controlsContainer) {
                    console.error(`Controls container not found for ${exerciseId}`);
                    return;
                }
                
                // Remove existing answer buttons (not the "New Exercise" button)
                const existingBtns = controlsContainer.querySelectorAll('.exercise-btn:not(.secondary)');
                existingBtns.forEach(btn => btn.remove());
                
                // Get the "New Exercise" button to append before it
                const newExerciseBtn = controlsContainer.querySelector('.exercise-btn.secondary');
                
                if (!newExerciseBtn) {
                    console.error(`New exercise button not found for ${exerciseId}`);
                    return;
                }
                
                // Create new option buttons
                options.forEach(option => {
                    const btn = document.createElement('button');
                    btn.className = 'exercise-btn';
                    btn.textContent = option;
                    
                    // Set the appropriate data attribute based on exercise type
                    if (exerciseId === 'exercise-1') {
                        btn.setAttribute('data-answer', option);
                    } else if (exerciseId === 'exercise-2') {
                        btn.setAttribute('data-chord', option);
                    } else if (exerciseId === 'exercise-3') {
                        btn.setAttribute('data-symbol', option);
                    }
                    
                    // Insert before the "New Exercise" button
                    controlsContainer.insertBefore(btn, newExerciseBtn);
                });
                
                console.log(`Updated buttons for ${exerciseId} with options:`, options);
            }

            function playTabNoteSound() {
                // Simple audio feedback for tab note clicks
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 440; // A note
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                } catch (e) {
                    // Audio not supported, fail silently
                    console.log('Audio not supported');
                }
            }
            
            // --- INITIALIZATION ---
            initLibraryPage();
            initSongsPage();
            initProgressPage();
            initPracticeTimer();
            initGuitarTips();
            initMetronome();
            initStrummingPatterns();
            initTabTutorial();
            
            // Make refresh function available globally for easy access
            console.log('🎉 To refresh after adding new chords, call: refreshAllPages()');
        });
    </script>
</body>
</html>
